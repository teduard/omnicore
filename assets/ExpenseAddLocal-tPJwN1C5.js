import{u as E,r as a,n as H,j as e,L as M,F as N,a as V,C as z,S as C,b as l,I as v,T as Y,H as G,B as S,c as U,E as F}from"./index-CWSV3jY4.js";import{S as q,C as J}from"./index-piDNkBxi.js";import{E as K}from"./ExpenseLayout-DjVUbk6I.js";import"./internal-BQAndi-F.js";import"./use-select-BPa5uJxM.js";function P(){const r=E(),[n,A]=a.useState(""),[d,D]=a.useState(""),{execute:c,isReady:u}=H(),[y,L]=a.useState([{type:"info",dismissible:!0,dismissLabel:"Dismiss message",onDismiss:()=>L([]),content:e.jsxs(e.Fragment,{children:["Your new expense was added"," ",e.jsx(M,{color:"inverted",href:"/expense",children:"see all expenses"}),"."]}),id:"added_expense"}]),B=t=>{D(parseFloat(t.detail.value).toString()),console.log(t)},_=t=>{A(t.detail.value)},o=new Date,[m,k]=a.useState(o.getFullYear()+"-"+(o.getMonth()<9?"0"+(o.getMonth()+1):o.getMonth()+1)+"-"+o.getDate()),[h,w]=a.useState(!1),[x,p]=a.useState({label:"loading...",value:0}),[i,g]=a.useState("idle"),I=t=>{t.preventDefault();const s={Amount:parseFloat(d),Category:parseInt(x.value),Comment:n,Date:m,CouldHaveBeenAvoided:h};console.log("payload:",s),g("fetching"),c(`INSERT INTO Expenses 
             (category_id, user_id,
             amount, comment, could_have_been_avoided, created_date, updated_date) VALUES 
             (${s.Category}, 1, ${s.Amount}, '${s.Comment}', ${s.CouldHaveBeenAvoided}, '${s.Date}', '${s.Date}')`),g("ok")},[$,f]=a.useState(!1),[O,b]=a.useState(!1);a.useEffect(()=>{b(i==="fetching"),f(i==="ok")},[i]);const[R,T]=a.useState([]);return a.useEffect(()=>{if(u){const t=c("SELECT * FROM Categories where user_id = 1");console.log("categories: ",t);const s=[];t&&t[0]&&t[0].values&&(t[0].values.map(j=>{s.push({label:j[2],value:j[0]})}),T(s),p(s[0]))}},[u]),e.jsxs(e.Fragment,{children:[$&&e.jsx(N,{items:y}),e.jsx("form",{onSubmit:I,children:e.jsx(V,{actions:e.jsxs(C,{direction:"horizontal",size:"xs",children:[e.jsx(S,{formAction:"none",variant:"link",onClick:()=>r("/dashboard/expense"),children:"Cancel"}),e.jsx(S,{variant:"primary",loading:O,children:"Add"})]}),children:e.jsx(z,{header:e.jsx(G,{variant:"h2",children:"New expense"}),children:e.jsxs(C,{direction:"vertical",size:"l",children:[e.jsx(l,{label:"Amount",children:e.jsx(v,{type:"number",value:d.toString(),onChange:B,placeholder:"0"})}),e.jsx(l,{label:"Category",children:e.jsx(q,{selectedOption:x,onChange:({detail:t})=>p(t.selectedOption),options:R})}),e.jsx(l,{label:"Comment",children:e.jsx(v,{value:n,onChange:_})}),e.jsx(l,{label:"Could have been avoided",children:e.jsx(Y,{onChange:({detail:t})=>w(t.checked),checked:h,children:"Yes"})}),e.jsx(l,{label:"Entry Date",children:e.jsx(J,{onChange:({detail:t})=>{console.log("calendar:",t),k(t.value)},value:m})})]})})})})]})}function Q(){return e.jsx(e.Fragment,{children:e.jsx(P,{})})}function W(){const r=E();return e.jsx(U,{items:[{text:"Dashboard",href:F.path},{text:"Add expense",href:`${F.path}/add`}],expandAriaLabel:"Show path",ariaLabel:"Breadcrumbs",onFollow:n=>{n.detail.external||(n.preventDefault(),r(n.detail.href))}})}function se(){return e.jsx(K,{content:e.jsx(Q,{}),breadcrumbs:e.jsx(W,{})})}export{se as default};

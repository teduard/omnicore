import{br as P,u as T,a as V,r as t,j as e,S as i,F as _,b as Y,C as G,c as r,I as E,T as J,H as W,B as S,l as C,A as $,E as y}from"./index-BNmEPKmQ.js";import{h as q,i as K}from"./useExpenses-Dd4ZDJH_.js";import{S as Q}from"./index-CBO8KeFk.js";import{C as U}from"./index-GCtq89iY.js";import{E as X}from"./ExpenseLayout-JxUEBJy9.js";import"./use-select--nlNNOp5.js";function Z(){const{expenseId:F}=P(),o=T(),d=parseInt(F??"0"),{data:a,isLoading:A}=q(d),{mutate:B,isPending:I}=K(),{execute:D,isReady:l}=V(),[c,u]=t.useState(""),[m,x]=t.useState(""),[h,p]=t.useState(!1),[g,f]=t.useState(""),[b,j]=t.useState({label:"",value:0}),[R,O]=t.useState([]),[k,H]=React.useState(!1),[L,N]=t.useState(""),[z,w]=t.useState([{type:"info",dismissible:!0,dismissLabel:"Dismiss message",onDismiss:()=>w([]),content:e.jsxs(e.Fragment,{children:["An error occurred while trying to add your expense item.",L]}),id:"added_expense"}]);t.useEffect(()=>{a&&(u(String(a.amount)),x(a.comment),p(!!a.couldHaveBeenAvoided),f(a.entryDate),j({label:a.category.name,value:a.category.categoryId}))},[a]),t.useEffect(()=>{if(!l)return;const s=D("SELECT category_id, name FROM Categories WHERE user_id = 1 ORDER BY name ASC");s?.[0]?.values?.length&&O(s[0].values.map(n=>({label:String(n[1]),value:Number(n[0])})))},[l]);const M=s=>{s.preventDefault();const n=parseFloat(c);isNaN(n)||n<=0||B({expenseId:d,categoryId:b.value,amount:n,comment:m,date:g,couldHaveBeenAvoided:h},{onSuccess:()=>{C.debug("expense was updated"),o(-1)},onError:v=>{H(!0),N(JSON.stringify(v)),C.error("Failed to update expense:",v)}})};return A?e.jsx("div",{children:"Loading..."}):a?e.jsxs(i,{direction:"vertical",size:"l",children:[k&&e.jsx(_,{items:z}),e.jsx("form",{onSubmit:M,children:e.jsx(Y,{actions:e.jsxs(i,{direction:"horizontal",size:"xs",children:[e.jsx(S,{formAction:"none",variant:"link",onClick:()=>o(-1),children:"Cancel"}),e.jsx(S,{variant:"primary",loading:I,children:"Save"})]}),children:e.jsx(G,{header:e.jsx(W,{variant:"h2",children:"Edit expense"}),children:e.jsxs(i,{direction:"vertical",size:"l",children:[e.jsx(r,{label:"Amount",children:e.jsx(E,{type:"number",value:c,onChange:s=>u(s.detail.value)})}),e.jsx(r,{label:"Category",children:e.jsx(Q,{selectedOption:b,onChange:({detail:s})=>j(s.selectedOption),options:R})}),e.jsx(r,{label:"Comment",children:e.jsx(E,{value:m,onChange:s=>x(s.detail.value)})}),e.jsx(r,{label:"Could have been avoided",children:e.jsx(J,{onChange:({detail:s})=>p(s.checked),checked:h,children:"Yes"})}),e.jsx(r,{label:"Entry Date",children:e.jsx(U,{onChange:({detail:s})=>f(s.value),value:g})})]})})})})]}):e.jsx("div",{children:"Expense not found."})}function ee(){return e.jsx(e.Fragment,{children:e.jsx(Z,{})})}function se(){return e.jsx($,{items:[{text:"Dashboard",href:y.path},{text:"Add expense",href:`${y.path}/add`}]})}function de(){return e.jsx(X,{content:e.jsx(ee,{}),breadcrumbs:e.jsx(se,{})})}export{de as default};

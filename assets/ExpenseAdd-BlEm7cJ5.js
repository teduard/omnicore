import{u as H,R as M,a as V,b as y,r as t,c as z,j as e,L as Y,F as G,d as P,C as U,S,e as i,I as F,T as q,H as J,B as E,f as K,E as D}from"./index-DhoDqbO4.js";import{S as Q}from"./index-oq0V42Dd.js";import{C as W}from"./internal-DeMV-7eK.js";import{E as X}from"./ExpenseLayout-BUpx8lid.js";import"./use-select-DpWPcQzn.js";function A({locale:o="",isDateEnabled:n=()=>!0,granularity:d="day",...l}){const c=H("Calendar",{props:{granularity:d},metadata:{hasDisabledReasons:!!l.dateDisabledReason}});return M.createElement(W,{...l,...c,locale:o,isDateEnabled:n,granularity:d})}V(A,"Calendar");function Z(){const o=y(),[n,d]=t.useState(""),[l,c]=t.useState(""),{execute:m,isReady:h}=z(),[B,L]=t.useState([{type:"info",dismissible:!0,dismissLabel:"Dismiss message",onDismiss:()=>L([]),content:e.jsxs(e.Fragment,{children:["Your new expense was added"," ",e.jsx(Y,{color:"inverted",href:"/expense",children:"see all expenses"}),"."]}),id:"added_expense"}]),R=a=>{c(parseFloat(a.detail.value).toString()),console.log(a)},_=a=>{d(a.detail.value)},r=new Date,[p,k]=t.useState(r.getFullYear()+"-"+(r.getMonth()<9?"0"+(r.getMonth()+1):r.getMonth()+1)+"-"+r.getDate()),[x,w]=t.useState(!1),[f,g]=t.useState({label:"loading...",value:0}),[u,b]=t.useState("idle"),$=a=>{a.preventDefault();const s={Amount:parseFloat(l),Category:parseInt(f.value),Comment:n,Date:p,CouldHaveBeenAvoided:x};console.log("payload:",s),b("fetching"),m(`INSERT INTO Expenses 
             (category_id, user_id,
             amount, comment, could_have_been_avoided, created_date, updated_date) VALUES 
             (${s.Category}, 1, ${s.Amount}, '${s.Comment}', ${s.CouldHaveBeenAvoided}, '${s.Date}', '${s.Date}')`),b("ok")},[I,C]=t.useState(!1),[N,j]=t.useState(!1);t.useEffect(()=>{j(u==="fetching"),C(u==="ok")},[u]);const[O,T]=t.useState([]);return t.useEffect(()=>{if(h){const a=m("SELECT * FROM Categories where user_id = 1");console.log("categories: ",a);const s=[];a&&a[0]&&a[0].values&&(a[0].values.map(v=>{s.push({label:v[2],value:v[0]})}),T(s),g(s[0]))}},[h]),e.jsxs(e.Fragment,{children:[I&&e.jsx(G,{items:B}),e.jsx("form",{onSubmit:$,children:e.jsx(P,{actions:e.jsxs(S,{direction:"horizontal",size:"xs",children:[e.jsx(E,{formAction:"none",variant:"link",onClick:()=>o("/dashboard/expense"),children:"Cancel"}),e.jsx(E,{variant:"primary",loading:N,children:"Add"})]}),children:e.jsx(U,{header:e.jsx(J,{variant:"h2",children:"New expense"}),children:e.jsxs(S,{direction:"vertical",size:"l",children:[e.jsx(i,{label:"Amount",children:e.jsx(F,{type:"number",value:l.toString(),onChange:R,placeholder:"0"})}),e.jsx(i,{label:"Category",children:e.jsx(Q,{selectedOption:f,onChange:({detail:a})=>g(a.selectedOption),options:O})}),e.jsx(i,{label:"Comment",children:e.jsx(F,{value:n,onChange:_})}),e.jsx(i,{label:"Could have been avoided",children:e.jsx(q,{onChange:({detail:a})=>w(a.checked),checked:x,children:"Yes"})}),e.jsx(i,{label:"Entry Date",children:e.jsx(A,{onChange:({detail:a})=>{console.log("calendar:",a),k(a.value)},value:p})})]})})})})]})}function ee(){return e.jsx(e.Fragment,{children:e.jsx(Z,{})})}function ae(){const o=y();return e.jsx(K,{items:[{text:"Dashboard",href:D.path},{text:"Add expense",href:`${D.path}/add`}],expandAriaLabel:"Show path",ariaLabel:"Breadcrumbs",onFollow:n=>{n.detail.external||(n.preventDefault(),o(n.detail.href))}})}function re(){return e.jsx(X,{content:e.jsx(ee,{}),breadcrumbs:e.jsx(ae,{})})}export{re as default};

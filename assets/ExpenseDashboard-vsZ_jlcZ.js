const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/highcharts-C7XplHEk.js","assets/index-i8URqjWk.js","assets/index-uu3zVhp3.css","assets/accessibility-BjfWnehx.js","assets/highcharts-more-MlHmJaxH.js"])))=>i.map(i=>d[i]);
import{v as B,R as o,w as J,x as D,y as oe,z as ne,h as le,l as ie,G as M,r as h,J as ce,K as G,N as Q,O as ue,p as de,j as t,C as F,H as I,t as _,U as q,L as z,P as $,S as R,Q as ge,q as ee,V as he,u as pe,f as xe,D as me,E as Ce,W as fe,X as k}from"./index-i8URqjWk.js";import{S,c as _e,a as ye,b as Pe,d as Ee,e as be,f as ve,g as we,h as Ae,i as je,j as Se,k as De,l as Ie,m as Le,n as Te,o as Ne,p as Be,q as Re,r as Fe,s as He,t as Me,u as $e,v as ke,w as Ve,x as ze,y as qe,z as Oe,A as We,B as Ke,C as Ue,D as Ye,E as Ge,F as Qe,G as Xe,H as Ze,I as Je,J as et,K as tt,L as at,M as st,N as rt,O as ot,P as nt,Q as lt,R as it,T as ct,U as ut,V as dt,W as gt,X as ht,Y as pt,Z as xt}from"./index-D_lqj6Qb.js";import{T as O}from"./index-w18fh6ws.js";import{M as mt}from"./MonthPicker-Cruv2OYY.js";import{E as Ct}from"./ExpenseLayout-Bg0ba4xj.js";import"./internal-Dxpm5i3b.js";function ft(e){if(e?.progressBar)return{[B.progressBarBackgroundColor]:e.progressBar.backgroundColor,[B.progressBarBorderRadius]:e.progressBar.borderRadius,[B.progressBarHeight]:e.progressBar.height}}function _t(e){if(e?.progressValue)return{[B.progressValueBackgroundColor]:e.progressValue.backgroundColor}}function yt(e){if(e?.progressPercentage)return{color:e.progressPercentage.color,fontSize:e.progressPercentage.fontSize,fontWeight:e.progressPercentage.fontWeight}}const d={progress:"awsui_progress_11huc_1oe95_189","result-state":"awsui_result-state_11huc_1oe95_203","awsui-motion-fade-in":"awsui_awsui-motion-fade-in_11huc_1oe95_1",root:"awsui_root_11huc_1oe95_225","with-result-button":"awsui_with-result-button_11huc_1oe95_257","result-text":"awsui_result-text_11huc_1oe95_261","result-container-error":"awsui_result-container-error_11huc_1oe95_265","result-container-success":"awsui_result-container-success_11huc_1oe95_265","result-button":"awsui_result-button_11huc_1oe95_269","word-wrap":"awsui_word-wrap_11huc_1oe95_275","label-flash":"awsui_label-flash_11huc_1oe95_280","label-key-value":"awsui_label-key-value_11huc_1oe95_284",flash:"awsui_flash_11huc_1oe95_292","progress-container":"awsui_progress-container_11huc_1oe95_296","percentage-container":"awsui_percentage-container_11huc_1oe95_303",percentage:"awsui_percentage_11huc_1oe95_303",complete:"awsui_complete_11huc_1oe95_349","additional-info":"awsui_additional-info_11huc_1oe95_363"},V=100,Pt=(e,r,s)=>Math.max(Math.min(e,s),r),Et=({value:e,isInFlash:r,ariaLabel:s,ariaLabelledby:a,ariaDescribedby:n,style:g})=>{const l=Math.round(e),u=Pt(l,0,V),i=ft(g),y=_t(g),P=yt(g);return o.createElement("div",{className:d["progress-container"]},o.createElement("progress",{className:D(d.progress,u>=V&&d.complete),max:V,value:u,"aria-label":s,"aria-labelledby":s?void 0:a,"aria-describedby":n,style:{...i||{},...y||{}}}),o.createElement("span",{"aria-hidden":"true",className:d["percentage-container"]},o.createElement(J,{className:d.percentage,variant:"small",color:r?"inherit":void 0,nativeAttributes:P?{style:P}:void 0},`${u}%`)))},X=({color:e,children:r,className:s,id:a})=>o.createElement(J,{className:D(d["word-wrap"],s),variant:"small",display:"block",color:e,id:a},r),bt=({onClick:e,children:r})=>o.createElement("div",{className:d["result-button"]},o.createElement(ne,{formAction:"none",onClick:e},r)),vt=({isInFlash:e,resultText:r,resultButtonText:s,status:a,onClick:n})=>{const g=!!s;return e?o.createElement("div",{className:d[`result-container-${a}`]},o.createElement("span",{className:d["result-text"]},r)):o.createElement("div",{className:d[`result-container-${a}`]},o.createElement("span",{className:D(g&&d["with-result-button"])},o.createElement(oe,{type:a==="success"?"success":"error"},o.createElement("span",{className:d["result-text"]},r))),g&&o.createElement(bt,{onClick:n},s))},wt=5e3;function te({value:e=0,status:r="in-progress",variant:s="standalone",resultButtonText:a,label:n,ariaLabel:g,ariaLabelledby:l,ariaDescribedby:u,description:i,additionalInfo:y,resultText:P,onResultButtonClick:b,style:L,...A}){const{__internalRootRef:C}=le("ProgressBar",{props:{variant:s}}),j=ie(A),T=`${M("awsui-progress-bar-")}-label`,f=s==="flash",x=r==="in-progress",v=M("progressbar-description-"),m=M("progressbar-additional-info-"),[w,c]=h.useState(""),p=ce(E=>{c(`${E}%`)},wt,[]);return h.useEffect(()=>{p(e)},[p,e]),o.createElement("div",{...j,className:D(j.className,d.root,s&&d[s]),ref:C},o.createElement("div",{className:f?d["flash-container"]:void 0},o.createElement("div",{className:D(d["word-wrap"],d[`label-${s}`]),id:T},n),i&&o.createElement(X,{color:f?"inherit":void 0,id:v},i),o.createElement("div",null,x?o.createElement(o.Fragment,null,o.createElement(Et,{value:e,ariaLabel:g,ariaLabelledby:G(T,l),ariaDescribedby:G(i?v:void 0,y?m:void 0,u),isInFlash:f,style:L}),o.createElement(Q,{hidden:!0,tagName:"span",delay:0},n,n?": ":null,w)):o.createElement(Q,{hidden:!1,tagName:"span",delay:0},o.createElement(vt,{resultText:P,isInFlash:f,resultButtonText:a,status:r,onClick:()=>{ue(b)}})))),y&&o.createElement(X,{className:d["additional-info"],color:f?"inherit":void 0,id:m},y))}de(te,"ProgressBar");function At({insightsDefinition:e,insightsItems:r,loadingStatus:s}){return s==="not-started"?t.jsx(_,{textAlign:"center",children:t.jsx(S,{type:"info",children:"Insights not loaded. Reload page"})}):s==="loading"?t.jsx(_,{textAlign:"center",children:t.jsx(S,{type:"loading",children:"Loading"})}):s==="error"?t.jsx(_,{textAlign:"center",children:t.jsx(S,{type:"error",children:"Error loading insights"})}):t.jsx(O,{enableKeyboardNavigation:!0,variant:"borderless",resizableColumns:!0,items:r,columnDefinitions:e})}function jt(e){const r=[{id:"name",header:"Metric",cell:a=>a.name,width:160,isRowHeader:!0},{id:"status",header:"Count",cell:({statusText:a,status:n})=>t.jsx(S,{type:n,children:a})}],s=[{name:"Total transactions",statusText:e.ExpenseItemsCount.toString(),status:"info"},{name:"Avoidable expenses",statusText:e.CouldHaveBeenAvoidedCount.toString(),status:"warning"}];return t.jsx(F,{header:t.jsx(I,{variant:"h2",description:"What to look after",children:"Insights"}),children:t.jsx(At,{insightsDefinition:r,insightsItems:s,loadingStatus:e.LoadingStatus})})}function St(e){const[r,s]=o.useState(),a=h.useContext(q),{defaultCurrency:n}=a,g=[{id:"name",header:"Category",cell:l=>t.jsx(z,{href:"#",children:l.name}),width:160,isRowHeader:!0},{id:"status",header:"Total Spent",cell:({statusText:l,status:u})=>`${l} ${n.value}`,width:140},{id:"quota",header:"Budget quota",cell:({statusText:l,status:u})=>t.jsxs(t.Fragment,{children:[t.jsx(S,{type:u,children:"30%"})," ","/"," ",parseFloat(l)*2," ",n.value]})}];return h.useEffect(()=>{const l=new Array;e.expenseAggregate.forEach(i=>{l.push({name:i.categoryName,statusText:i.categoryAmount.toString(),status:"info"})}),s(l)},[e.expenseAggregate]),t.jsx(F,{header:t.jsx(I,{variant:"h2",description:"Transactions aggregated by category",children:"Category summary"}),children:t.jsx(O,{enableKeyboardNavigation:!0,variant:"borderless",resizableColumns:!0,items:r,columnDefinitions:g,loading:e.LoadingStatus==="loading",loadingText:"Loading category aggregates",footer:t.jsx(_,{textAlign:"center",children:t.jsxs("h3",{children:["Total: ",t.jsxs("b",{children:[e.expenseTotal," ",n.value]})]})})})})}const Z=e=>`${(e*100).toFixed(0)}%`,Dt=()=>{const[e,r]=h.useState(null);return h.useEffect(()=>{(async()=>{const a=await $(()=>import("./highcharts-C7XplHEk.js").then(n=>n.h),__vite__mapDeps([0,1,2]));await $(()=>import("./accessibility-BjfWnehx.js").then(n=>n.a),__vite__mapDeps([3,1,2])),await $(()=>import("./highcharts-more-MlHmJaxH.js").then(n=>n.h),__vite__mapDeps([4,1,2])),r(a)})()},[]),e},It=[_e,ye,Pe,Ee,be,ve,we,Ae,je,Se,De,Ie,Le,Te,Ne,Be,Re,Fe,He,Me,$e,ke,Ve,ze,qe,Oe,We,Ke,Ue,Ye,Ge,Qe,Xe,Ze,Je,et,tt,at,st,rt,ot,nt,lt,it,ct,ut,dt,gt,ht,pt];function Lt(e){const r=h.useContext(q),{defaultCurrency:s}=r,a=Dt(),[n,g]=h.useState([]);return h.useEffect(()=>{const l=new Array;let u=0;e.expenseAggregate.forEach(i=>{i.categoryAmount>0&&l.push({name:i.categoryName,y:i.categoryAmount,color:It[u++]})}),g(l)},[e.expenseAggregate]),t.jsx(t.Fragment,{children:t.jsx(F,{header:t.jsx(I,{variant:"h2",description:"Your expenses at a glance",children:"Expenses aggregate by category"}),children:t.jsx(xt,{highcharts:a,noData:{statusType:"finished",empty:t.jsxs("div",{children:[t.jsx(_,{fontWeight:"bold",textAlign:"center",color:"inherit",children:"No expenses available"}),t.jsx(_,{textAlign:"center",color:"inherit",children:"for the selected period"})]})},series:{type:"donut",name:"Zone status",data:n},ariaLabel:"Category aggregate chart",innerAreaDescription:s.value,innerAreaTitle:e.expenseTotal.toString(),segmentDescription:({segmentValue:l,totalValue:u})=>`${l} zones, ${Z(l/u)}`,tooltip:{details:({segmentValue:l,totalValue:u})=>[{key:"Zone count",value:l},{key:"Percentage",value:Z(l/u)}]},i18nStrings:{chartRoleDescription:"Pie chart summarizing the status of all zones.",seriesFilterLabel:"Filter displayed data",seriesFilterPlaceholder:"Filter data",seriesFilterSelectedAriaLabel:"selected",detailPopoverDismissAriaLabel:"Dismiss",legendAriaLabel:"Legend",segmentRoleDescription:"segment"}})})})}function Tt(e){const r=h.useContext(q),{defaultCurrency:s}=r;return t.jsx(O,{loading:e.LoadingStatus==="loading",loadingText:"Loading expenses",renderAriaLive:({firstIndex:a,lastIndex:n,totalItemsCount:g})=>`Displaying items ${a} to ${n} of ${g}`,columnDefinitions:[{id:"entryDate",header:"Entry Date",cell:a=>t.jsx(z,{href:"/expense/edit/"+a.expenseId,children:a.entryDate||"-"}),sortingField:"name",isRowHeader:!0},{id:"amount",header:"Amount",cell:a=>`${a.amount} ${s.value}`||"-",sortingField:"alt"},{id:"category",header:"Category",cell:a=>a.category||"-"},{id:"comment",header:"Comment",cell:a=>a.comment||"-"}],enableKeyboardNavigation:!0,items:e.expenseData,sortingDisabled:!0,stripedRows:!0,empty:t.jsx(_,{margin:{vertical:"xs"},textAlign:"center",color:"inherit",children:t.jsx(R,{size:"m",children:t.jsx("b",{children:"No expenses"})})}),header:t.jsx(I,{children:" Latest Expenses "}),footer:t.jsx(_,{textAlign:"center",children:t.jsx(z,{href:"/omnicore/dashboard/expense/costlocal",variant:"primary",children:"View all expenses"})})})}const Nt=e=>{const r=h.useContext(ge),{service:s}=r,{isReady:a}=ee();return he({queryKey:["expenses",e],queryFn:async()=>await s.getExpenses(e),enabled:a,refetchOnWindowFocus:!1,staleTime:1/0})};function Bt(){ee();const{selectedDate:e,updateDate:r}=fe(),[s,a]=h.useState(""),[n,g]=h.useState(0),{data:l=[],isLoading:u}=Nt(e),[i,y]=o.useState(new Array);h.useEffect(()=>{const x=new Date,v=x.getDate(),m=x.getMonth(),w=x.getFullYear(),c=parseInt(e.split("-")[0]),p=parseInt(e.split("-")[1])-1;if(w==c&&m==p){const E=new Date(w,m,1),H=new Date(w,m,v),K=new Date(c,p+1,0),N=1e3*60*60*24,ae=K.getTime()-H.getTime()+N,U=Math.round(ae/N);a(`There are ${U} days till the end of month.`);const se=K.getTime()-E.getTime()+N,Y=Math.round(se/N),re=(Y-U)/Y*100;g(re)}else a("This month has passed"),g(100)},[e]);const P={ExpenseItemsCount:0,CouldHaveBeenAvoidedCount:0,LoadingStatus:"not-started"},[b,L]=o.useState(P),A={expenseAggregate:new Array,expenseTotal:0,LoadingStatus:"not-started"},[C,j]=o.useState(A),[W,T]=o.useState(new Array),f=()=>{L({...P,LoadingStatus:"loading"}),j({...A,LoadingStatus:"loading"}),console.log("selectedDate = ",e),y(l)};return h.useEffect(()=>{const x=new Array;i.forEach(c=>{const p={expenseId:c.expenseId,entryDate:c.entryDate,amount:c.amount,category:c.category.name,comment:c.comment,couldHaveBeenAvoided:c.couldHaveBeenAvoided};x.push(p)}),T(x.slice(Math.max(x.length-10,0))),L({ExpenseItemsCount:i.length,CouldHaveBeenAvoidedCount:i.filter(c=>c.couldHaveBeenAvoided===!0).length,LoadingStatus:"success"});const v=i.reduce((c,p)=>c+p.amount,0).toFixed(2),m=new Array;i.reduce((c,p)=>c.add(p.category.name),new Set).forEach(c=>{const p={categoryName:c,categoryAmount:0};p.categoryAmount=parseFloat(i.filter(E=>E.category.name===c).reduce((E,H)=>E+H.amount,0).toFixed(2)),m.push(p)}),j({...A,expenseAggregate:m,expenseTotal:v||0,LoadingStatus:"success"})},[i]),h.useEffect(()=>{u||f()},[u]),t.jsx(t.Fragment,{children:t.jsxs(k,{gridDefinition:[{colspan:{default:12}},{colspan:{default:12}}],children:[t.jsx(F,{header:t.jsx(I,{variant:"h1",children:"Current status"}),children:t.jsxs(k,{gridDefinition:[{colspan:{default:12,xs:7}},{colspan:{default:12,xs:5}}],children:[t.jsx("div",{children:t.jsx(te,{value:n,additionalInfo:s,label:"Month progress"})}),t.jsx(R,{direction:"vertical",size:"l",children:t.jsx(mt,{onRefresh:f})})]})}),t.jsxs(k,{gridDefinition:[{colspan:{default:12,m:7,s:8,l:6,xl:6,xxs:12,xs:12}},{colspan:{default:12,m:5,s:4,l:6,xl:6,xxs:12,xs:12}}],children:[t.jsxs(R,{size:"l",children:[t.jsx(Lt,{LoadingStatus:C.LoadingStatus,expenseAggregate:C.expenseAggregate,expenseTotal:C.expenseTotal}),t.jsx(Tt,{expenseData:W,LoadingStatus:b.LoadingStatus,onMonthChange:()=>{console.log("empty month change")}})]}),t.jsxs(R,{size:"l",children:[t.jsx(jt,{ExpenseItemsCount:b.ExpenseItemsCount,CouldHaveBeenAvoidedCount:b.CouldHaveBeenAvoidedCount,LoadingStatus:b.LoadingStatus}),t.jsx(St,{LoadingStatus:C.LoadingStatus,expenseAggregate:C.expenseAggregate,expenseTotal:C.expenseTotal})]})]})]})})}function Rt(){const e=pe();return t.jsx(xe,{items:[{text:"Dashboard",href:`/omnicore/${me.path}/preferences`},{text:"Expense",href:Ce.path}],expandAriaLabel:"Show path",ariaLabel:"Breadcrumbs",onFollow:r=>{if(!r.detail.external){const s=r.detail.href.replace("/omnicore/","/");r.preventDefault(),e(s)}}})}function zt(){return t.jsx(t.Fragment,{children:t.jsx(Ct,{content:t.jsx(Bt,{}),breadcrumbs:t.jsx(Rt,{})})})}export{zt as default};

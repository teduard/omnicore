const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/highcharts-CjTu-j6w.js","assets/index-Bj2MUn9q.js","assets/index-DwnPCk4l.css","assets/accessibility-CrIjxFlH.js","assets/highcharts-more-CuO7n9V6.js"])))=>i.map(i=>d[i]);
import{y as T,R as r,a8 as Z,q as D,al as X,W as J,c as ee,g as te,n as F,r as d,o as W,N as Y,t as ae,i as se,j as t,C as R,H as L,k as w,L as O,am as H,S as j,B as re,u as oe,a as ne,D as le,E as ie,an as ce,M as de,b as ue,ao as M}from"./index-Bj2MUn9q.js";import{S,c as ge,a as he,b as pe,d as me,e as xe,f as Ce,g as fe,h as _e,i as Ee,j as ye,k as Pe,l as be,m as ve,n as we,o as Ae,p as je,q as Se,r as De,s as Le,t as Ie,u as Be,v as Ne,w as Te,x as Re,y as ke,z as Fe,A as He,B as Me,C as $e,D as Oe,E as ze,F as Ve,G as qe,H as We,I as Ye,J as Ke,K as Ue,L as Ge,M as Ze,N as Qe,O as Xe,P as Je,Q as et,R as tt,T as at,U as st,V as rt,W as ot,X as nt,Y as lt,Z as it}from"./index-Cbnic_rz.js";import{T as z}from"./index-B_T0Znjq.js";import{a as ct}from"./index-28g6udv-.js";import{M as dt}from"./MonthPicker-CkXXlndD.js";import{u as ut,E as gt,B as K}from"./ExpenseLayout-DQHk7F6L.js";import{u as ht}from"./useDatabase-Ddn2wrX2.js";import"./use-select-xZE1YDyp.js";import"./internal-CSiE5gFz.js";import"./index-Ccz6MWjI.js";function pt(e){if(e?.progressBar)return{[T.progressBarBackgroundColor]:e.progressBar.backgroundColor,[T.progressBarBorderRadius]:e.progressBar.borderRadius,[T.progressBarHeight]:e.progressBar.height}}function mt(e){if(e?.progressValue)return{[T.progressValueBackgroundColor]:e.progressValue.backgroundColor}}function xt(e){if(e?.progressPercentage)return{color:e.progressPercentage.color,fontSize:e.progressPercentage.fontSize,fontWeight:e.progressPercentage.fontWeight}}const c={progress:"awsui_progress_11huc_1oe95_189","result-state":"awsui_result-state_11huc_1oe95_203","awsui-motion-fade-in":"awsui_awsui-motion-fade-in_11huc_1oe95_1",root:"awsui_root_11huc_1oe95_225","with-result-button":"awsui_with-result-button_11huc_1oe95_257","result-text":"awsui_result-text_11huc_1oe95_261","result-container-error":"awsui_result-container-error_11huc_1oe95_265","result-container-success":"awsui_result-container-success_11huc_1oe95_265","result-button":"awsui_result-button_11huc_1oe95_269","word-wrap":"awsui_word-wrap_11huc_1oe95_275","label-flash":"awsui_label-flash_11huc_1oe95_280","label-key-value":"awsui_label-key-value_11huc_1oe95_284",flash:"awsui_flash_11huc_1oe95_292","progress-container":"awsui_progress-container_11huc_1oe95_296","percentage-container":"awsui_percentage-container_11huc_1oe95_303",percentage:"awsui_percentage_11huc_1oe95_303",complete:"awsui_complete_11huc_1oe95_349","additional-info":"awsui_additional-info_11huc_1oe95_363"},$=100,Ct=(e,a,s)=>Math.max(Math.min(e,s),a),ft=({value:e,isInFlash:a,ariaLabel:s,ariaLabelledby:n,ariaDescribedby:o,style:i})=>{const h=Math.round(e),p=Ct(h,0,$),g=pt(i),C=mt(i),E=xt(i);return r.createElement("div",{className:c["progress-container"]},r.createElement("progress",{className:D(c.progress,p>=$&&c.complete),max:$,value:p,"aria-label":s,"aria-labelledby":s?void 0:n,"aria-describedby":o,style:{...g||{},...C||{}}}),r.createElement("span",{"aria-hidden":"true",className:c["percentage-container"]},r.createElement(Z,{className:c.percentage,variant:"small",color:a?"inherit":void 0,nativeAttributes:E?{style:E}:void 0},`${p}%`)))},U=({color:e,children:a,className:s,id:n})=>r.createElement(Z,{className:D(c["word-wrap"],s),variant:"small",display:"block",color:e,id:n},a),_t=({onClick:e,children:a})=>r.createElement("div",{className:c["result-button"]},r.createElement(J,{formAction:"none",onClick:e},a)),Et=({isInFlash:e,resultText:a,resultButtonText:s,status:n,onClick:o})=>{const i=!!s;return e?r.createElement("div",{className:c[`result-container-${n}`]},r.createElement("span",{className:c["result-text"]},a)):r.createElement("div",{className:c[`result-container-${n}`]},r.createElement("span",{className:D(i&&c["with-result-button"])},r.createElement(X,{type:n==="success"?"success":"error"},r.createElement("span",{className:c["result-text"]},a))),i&&r.createElement(_t,{onClick:o},s))},yt=5e3;function Q({value:e=0,status:a="in-progress",variant:s="standalone",resultButtonText:n,label:o,ariaLabel:i,ariaLabelledby:h,ariaDescribedby:p,description:g,additionalInfo:C,resultText:E,onResultButtonClick:V,style:k,...m}){const{__internalRootRef:I}=ee("ProgressBar",{props:{variant:s}}),B=te(m),A=`${F("awsui-progress-bar-")}-label`,f=s==="flash",x=a==="in-progress",y=F("progressbar-description-"),P=F("progressbar-additional-info-"),[N,l]=d.useState(""),u=ut(_=>{l(`${_}%`)},yt,[]);return d.useEffect(()=>{u(e)},[u,e]),r.createElement("div",{...B,className:D(B.className,c.root,s&&c[s]),ref:I},r.createElement("div",{className:f?c["flash-container"]:void 0},r.createElement("div",{className:D(c["word-wrap"],c[`label-${s}`]),id:A},o),g&&r.createElement(U,{color:f?"inherit":void 0,id:y},g),r.createElement("div",null,x?r.createElement(r.Fragment,null,r.createElement(ft,{value:e,ariaLabel:i,ariaLabelledby:W(A,h),ariaDescribedby:W(g?y:void 0,C?P:void 0,p),isInFlash:f,style:k}),r.createElement(Y,{hidden:!0,tagName:"span",delay:0},o,o?": ":null,N)):r.createElement(Y,{hidden:!1,tagName:"span",delay:0},r.createElement(Et,{resultText:E,isInFlash:f,resultButtonText:n,status:a,onClick:()=>{ae(V)}})))),C&&r.createElement(U,{className:c["additional-info"],color:f?"inherit":void 0,id:P},C))}se(Q,"ProgressBar");function Pt(){const[e,a]=d.useState(!0);return d.useEffect(()=>{function s(){console.log("in hook, handle online"),a(!0)}function n(){console.log("in hook, handle offline"),a(!1)}return window.addEventListener("online",s),window.addEventListener("offline",n),()=>{window.removeEventListener("online",s),window.removeEventListener("offline",n)}},[]),e}function bt({insightsDefinition:e,insightsItems:a,loadingStatus:s}){return s==="not-started"?t.jsx(w,{textAlign:"center",children:t.jsx(S,{type:"info",children:"Insights not loaded. Reload page"})}):s==="loading"?t.jsx(w,{textAlign:"center",children:t.jsx(S,{type:"loading",children:"Loading"})}):s==="error"?t.jsx(w,{textAlign:"center",children:t.jsx(S,{type:"error",children:"Error loading insights"})}):t.jsx(z,{enableKeyboardNavigation:!0,variant:"borderless",resizableColumns:!0,items:a,columnDefinitions:e})}function vt(e){const a=[{id:"name",header:"Metric",cell:n=>n.name,width:160,isRowHeader:!0},{id:"status",header:"Count",cell:({statusText:n,status:o})=>t.jsx(S,{type:o,children:n})}],s=[{name:"Expense days",statusText:e.ExpenseItemsCount.toString(),status:"info"},{name:"Total transactions",statusText:e.ExpenseItemsCount.toString(),status:"info"},{name:"Avoidable expenses",statusText:e.CouldHaveBeenAvoidedCount.toString(),status:"warning"}];return t.jsx(R,{header:t.jsx(L,{variant:"h2",description:"What to look after",children:"Insights"}),children:t.jsx(bt,{insightsDefinition:a,insightsItems:s,loadingStatus:e.LoadingStatus})})}const wt=[{id:"name",header:"Category",cell:e=>t.jsx(O,{href:"#",children:e.name}),width:160,isRowHeader:!0},{id:"status",header:"Total Spent",cell:({statusText:e,status:a})=>e+" RON",width:140},{id:"quota",header:"Budget quota",cell:({statusText:e,status:a})=>t.jsxs(t.Fragment,{children:[t.jsx(S,{type:a,children:"30%"})," ","/"," ",parseFloat(e)*2," RON"]})}];function At(e){const[a,s]=r.useState();return d.useEffect(()=>{const n=new Array;e.expenseAggregate.forEach(i=>{n.push({name:i.categoryName,statusText:i.categoryAmount.toString(),status:"info"})}),s(n)},[e.expenseAggregate]),t.jsx(R,{header:t.jsx(L,{variant:"h2",description:"Transactions aggregated by category",children:"Category summary"}),children:t.jsx(z,{enableKeyboardNavigation:!0,variant:"borderless",resizableColumns:!0,items:a,columnDefinitions:wt,loading:e.LoadingStatus==="loading",loadingText:"Loading category aggregates",footer:t.jsx(w,{textAlign:"center",children:t.jsxs("h3",{children:["Total: ",t.jsxs("b",{children:[e.expenseTotal," RON"]})]})})})})}const G=e=>`${(e*100).toFixed(0)}%`,jt=()=>{const[e,a]=d.useState(null);return d.useEffect(()=>{(async()=>{const n=await H(()=>import("./highcharts-CjTu-j6w.js").then(o=>o.h),__vite__mapDeps([0,1,2]));await H(()=>import("./accessibility-CrIjxFlH.js").then(o=>o.a),__vite__mapDeps([3,1,2])),await H(()=>import("./highcharts-more-CuO7n9V6.js").then(o=>o.h),__vite__mapDeps([4,1,2])),a(n)})()},[]),e},St=[ge,he,pe,me,xe,Ce,fe,_e,Ee,ye,Pe,be,ve,we,Ae,je,Se,De,Le,Ie,Be,Ne,Te,Re,ke,Fe,He,Me,$e,Oe,ze,Ve,qe,We,Ye,Ke,Ue,Ge,Ze,Qe,Xe,Je,et,tt,at,st,rt,ot,nt,lt];function Dt(e){const a=jt(),[s,n]=d.useState([]);return d.useEffect(()=>{const o=new Array;let i=0;e.expenseAggregate.forEach(h=>{h.categoryAmount>0&&o.push({name:h.categoryName,y:h.categoryAmount,color:St[i++]})}),n(o)},[e.expenseAggregate]),t.jsx(t.Fragment,{children:t.jsx(R,{header:t.jsx(L,{variant:"h2",description:"Your expenses at a glance",children:"Expenses aggregate by category"}),children:t.jsx(it,{highcharts:a,noData:{statusType:"loading"},series:{type:"donut",name:"Zone status",data:s},ariaLabel:"Category aggregate chart",innerAreaDescription:"RON",innerAreaTitle:e.expenseTotal.toString(),segmentDescription:({segmentValue:o,totalValue:i})=>`${o} zones, ${G(o/i)}`,tooltip:{details:({segmentValue:o,totalValue:i})=>[{key:"Zone count",value:o},{key:"Percentage",value:G(o/i)}]},i18nStrings:{chartRoleDescription:"Pie chart summarizing the status of all zones.",seriesFilterLabel:"Filter displayed data",seriesFilterPlaceholder:"Filter data",seriesFilterSelectedAriaLabel:"selected",detailPopoverDismissAriaLabel:"Dismiss",legendAriaLabel:"Legend",segmentRoleDescription:"segment"}})})})}function Lt(e){return t.jsx(z,{loading:e.LoadingStatus==="loading",loadingText:"Loading expenses",renderAriaLive:({firstIndex:a,lastIndex:s,totalItemsCount:n})=>`Displaying items ${a} to ${s} of ${n}`,columnDefinitions:[{id:"entryDate",header:"Entry Date",cell:a=>t.jsx(O,{href:"/expense/edit/"+a.expenseId,children:a.entryDate||"-"}),sortingField:"name",isRowHeader:!0},{id:"amount",header:"Amount",cell:a=>a.amount||"-",sortingField:"alt"},{id:"category",header:"Category",cell:a=>a.category||"-"},{id:"comment",header:"Comment",cell:a=>a.comment||"-"}],enableKeyboardNavigation:!0,items:e.expenseData,sortingDisabled:!0,stripedRows:!0,empty:t.jsx(w,{margin:{vertical:"xs"},textAlign:"center",color:"inherit",children:t.jsxs(j,{size:"m",children:[t.jsx("b",{children:"No resources"}),t.jsx(re,{children:"Create resource"})]})}),header:t.jsx(L,{children:" Latest Expenses "}),footer:t.jsx(w,{textAlign:"center",children:t.jsx(O,{href:"/expense/cost",variant:"primary",children:"View all expenses"})})})}function It(){const{execute:e,isReady:a}=ht(),{selectedDate:s,updateDate:n}=ce();Pt();const o={ExpenseItemsCount:0,CouldHaveBeenAvoidedCount:0,LoadingStatus:"not-started"},[i,h]=r.useState(o),p={expenseAggregate:new Array,expenseTotal:0,LoadingStatus:"not-started"},[g,C]=r.useState(p),[E,V]=d.useState(de.Light),k={tokens:{colorBackgroundLayoutMain:{light:"white",dark:"blue"},colorTextAccent:"#0073bb"},contexts:{"top-navigation":{tokens:{colorBackgroundContainerContent:"#1e324f"}}}};d.useEffect(()=>{ue(E),ct({theme:k})},[E]);const[m,I]=r.useState(new Array),[B,q]=r.useState(new Array),A=()=>{const x=new Array,y=s.split("-"),P=parseInt(y[0]),N=parseInt(y[1]),l=new Date(P,N,0),u=`${l.getFullYear()}-${l.getMonth()<9?"0"+(l.getMonth()+1):l.getMonth()+1}-${l.getDate()}}`,_=`SELECT e.*,c.name, c.category_id FROM Expenses e
      join Categories c
      on e.category_id = c.category_id
      WHERE 
      e.created_date >= '${s}-01' and e.created_date <= '${u}'
      `;console.log("sql = ",_);const v=e(_);return console.log("fetch expenses. res = ",v),console.log("selectedDate = ",s),!v||v.length===0?console.log("no expenses"):(v[0].values.map(b=>{x.push({expenseId:b[0],category:{name:b[8],categoryId:b[9]},entryDate:b[6],amount:b[3],comment:b[4],couldHaveBeenAvoided:b[5]})}),console.log("catData:",x)),x};d.useEffect(()=>{a&&I(A())},[a]);const f=()=>{h({...o,LoadingStatus:"loading"}),C({...p,LoadingStatus:"loading"}),I(A())};return d.useEffect(()=>{const x=new Array;m.forEach(l=>{const u={expenseId:l.expenseId,entryDate:l.entryDate,amount:l.amount,category:l.category.name,comment:l.comment,couldHaveBeenAvoided:l.couldHaveBeenAvoided};x.push(u)}),q(x.slice(Math.max(x.length-10,0))),h({ExpenseItemsCount:m.length,CouldHaveBeenAvoidedCount:m.filter(l=>l.couldHaveBeenAvoided===!0).length,LoadingStatus:"success"});const y=m.reduce((l,u)=>l+u.amount,0).toFixed(2),P=new Array;m.reduce((l,u)=>l.add(u.category.name),new Set).forEach(l=>{const u={categoryName:l,categoryAmount:0};u.categoryAmount=parseFloat(m.filter(_=>_.category.name===l).reduce((_,v)=>_+v.amount,0).toFixed(2)),P.push(u)}),C({...p,expenseAggregate:P,expenseTotal:y||0,LoadingStatus:"success"})},[m]),d.useEffect(()=>{f()},[]),t.jsx(t.Fragment,{children:t.jsxs(M,{gridDefinition:[{colspan:{default:12}},{colspan:{default:12}}],children:[t.jsx(R,{header:t.jsx(L,{variant:"h1",children:"Current status"}),children:t.jsxs(M,{gridDefinition:[{colspan:{default:7}},{colspan:{default:5}}],children:[t.jsxs("div",{children:[t.jsx(Q,{value:36,additionalInfo:"There are 13 days till the end of month",label:"Month progress"}),t.jsx("h4",{children:"Your are likely to exceed the budget on these categories"}),t.jsxs(j,{direction:"horizontal",size:"xs",children:[t.jsx(K,{color:"severity-low",children:"Food"}),t.jsx(K,{color:"severity-low",children:"House"})]})]}),t.jsx(j,{direction:"vertical",size:"l",children:t.jsx(dt,{onRefresh:f})})]})}),t.jsxs(M,{gridDefinition:[{colspan:{default:12,m:7,s:8,l:6,xl:6,xxs:12,xs:12}},{colspan:{default:12,m:5,s:4,l:6,xl:6,xxs:12,xs:12}}],children:[t.jsxs(j,{size:"l",children:[t.jsx(Dt,{LoadingStatus:g.LoadingStatus,expenseAggregate:g.expenseAggregate,expenseTotal:g.expenseTotal}),t.jsx(Lt,{expenseData:B,LoadingStatus:i.LoadingStatus})]}),t.jsxs(j,{size:"l",children:[t.jsx(vt,{ExpenseItemsCount:i.ExpenseItemsCount,CouldHaveBeenAvoidedCount:i.CouldHaveBeenAvoidedCount,LoadingStatus:i.LoadingStatus}),t.jsx(At,{LoadingStatus:g.LoadingStatus,expenseAggregate:g.expenseAggregate,expenseTotal:g.expenseTotal})]})]})]})})}function Bt(){const e=oe();return t.jsx(ne,{items:[{text:"Dashboard",href:le.path},{text:"Expense",href:ie.path}],expandAriaLabel:"Show path",ariaLabel:"Breadcrumbs",onFollow:a=>{a.detail.external||(a.preventDefault(),e(a.detail.href))}})}function Vt(){return t.jsx(t.Fragment,{children:t.jsx(gt,{content:t.jsx(It,{}),breadcrumbs:t.jsx(Bt,{})})})}export{Vt as default};

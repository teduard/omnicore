import{bq as O,u as L,a as N,r as a,j as e,b as z,C as P,S as j,c as r,I as v,T,H as w,B as E,l as b,A as Y,E as C}from"./index-D5ZTpl4d.js";import{h as _,i as q}from"./useExpenses-BlkLOWNp.js";import{S as G}from"./index-CvlSTGqc.js";import{C as M}from"./index-7IoUYSpT.js";import{E as V}from"./ExpenseLayout-DuAMmXcG.js";import"./use-select-seJ8svN_.js";function W(){const{expenseId:S}=O(),y=L(),o=parseInt(S??"0"),{data:n,isLoading:A}=_(o),{mutate:B,isPending:F}=q(),{execute:I,isReady:i}=N(),[d,l]=a.useState(""),[c,u]=a.useState(""),[x,m]=a.useState(!1),[p,h]=a.useState(""),[g,f]=a.useState({label:"",value:0}),[R,D]=a.useState([]);a.useEffect(()=>{n&&(l(String(n.amount)),u(n.comment),m(!!n.couldHaveBeenAvoided),h(n.entryDate),f({label:n.category.name,value:n.category.categoryId}))},[n]),a.useEffect(()=>{if(!i)return;const t=I("SELECT category_id, name FROM Categories WHERE user_id = 1 ORDER BY name ASC");t?.[0]?.values?.length&&D(t[0].values.map(s=>({label:String(s[1]),value:Number(s[0])})))},[i]);const k=t=>{t.preventDefault();const s=parseFloat(d);isNaN(s)||s<=0||B({expenseId:o,categoryId:g.value,amount:s,comment:c,date:p,couldHaveBeenAvoided:x},{onSuccess:()=>{b.debug("expense was updated")},onError:H=>b.error("Failed to update expense:",H)})};return A?e.jsx("div",{children:"Loading..."}):n?e.jsx("form",{onSubmit:k,children:e.jsx(z,{actions:e.jsxs(j,{direction:"horizontal",size:"xs",children:[e.jsx(E,{formAction:"none",variant:"link",onClick:()=>y(-1),children:"Cancel"}),e.jsx(E,{variant:"primary",loading:F,children:"Save"})]}),children:e.jsx(P,{header:e.jsx(w,{variant:"h2",children:"Edit expense"}),children:e.jsxs(j,{direction:"vertical",size:"l",children:[e.jsx(r,{label:"Amount",children:e.jsx(v,{type:"number",value:d,onChange:t=>l(t.detail.value)})}),e.jsx(r,{label:"Category",children:e.jsx(G,{selectedOption:g,onChange:({detail:t})=>f(t.selectedOption),options:R})}),e.jsx(r,{label:"Comment",children:e.jsx(v,{value:c,onChange:t=>u(t.detail.value)})}),e.jsx(r,{label:"Could have been avoided",children:e.jsx(T,{onChange:({detail:t})=>m(t.checked),checked:x,children:"Yes"})}),e.jsx(r,{label:"Entry Date",children:e.jsx(M,{onChange:({detail:t})=>h(t.value),value:p})})]})})})}):e.jsx("div",{children:"Expense not found."})}function $(){return e.jsx(e.Fragment,{children:e.jsx(W,{})})}function J(){return e.jsx(Y,{items:[{text:"Dashboard",href:C.path},{text:"Add expense",href:`${C.path}/add`}]})}function te(){return e.jsx(V,{content:e.jsx($,{}),breadcrumbs:e.jsx(J,{})})}export{te as default};

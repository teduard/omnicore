import{R as y,u as $,h as k,g as R,i as L,k as S,l as T,m as F,a as N,r as h,A as M,c as z,b as C,j as e,H,S as j,B as f,E as x,n as P,o as G,f as K,D as O}from"./index-DhoDqbO4.js";import{E as U}from"./ExpenseLayout-BUpx8lid.js";import{T as W}from"./index-DFzylMm4.js";const D=y.forwardRef(({items:i,variant:s="normal",loading:d=!1,loadingText:u,disabled:c=!1,disabledReason:m,expandableGroups:r=!1,expandToViewport:p=!1,ariaLabel:l,children:n,onItemClick:g,onItemFollow:b,mainAction:t,fullWidth:a,nativeMainActionAttributes:o,nativeTriggerAttributes:I,renderItem:_,...v},A)=>{const B=$("ButtonDropdown",{props:{expandToViewport:p,expandableGroups:r,variant:s},metadata:{mainAction:!!t,checkboxItems:R(i),hasDisabledReason:!!m,hasDisabledReasons:k(i)}}),E=L(v),w={name:"awsui.ButtonDropdown",label:`.${F["trigger-label"]}`,properties:{variant:s,disabled:`${c}`}};return y.createElement(S,{...E,...B,renderItem:_,ref:A,items:i,variant:s,loading:d,loadingText:u,disabled:c,disabledReason:m,expandableGroups:r,expandToViewport:p,ariaLabel:l,onItemClick:g,onItemFollow:b,mainAction:t,fullWidth:a,nativeMainActionAttributes:o,nativeTriggerAttributes:I,...T({component:w})},n)});N(D,"ButtonDropdown");function Y(){const i=h.useContext(M),{user:s}=i,{execute:d,isReady:u}=z(),c=C(),m=[],[r,p]=h.useState(m),l=()=>{const t=new Array,a=d(`
       select c.*, count(e.expense_id) as expense_count from Categories c
left join Expenses e
on c.user_id = e.user_id and c.category_id = e.category_id
where c.user_id =${s.UserId}
group by c.category_id
      
      `);!a||a.length===0?console.log("no categories"):(a[0].values.map(o=>{t.push({category_id:o[0],user_id:o[1],name:o[2],created_date:o[3],expense_count:o[4]})}),p(t))};h.useEffect(()=>{u&&l()},[u]);const[n,g]=h.useState([]),b=t=>{switch(t.detail.id){case"edit":console.log("edit category");break;case"delete":d(`DELETE FROM Categories where category_id = '${n[0].category_id}'`),l();break}};return e.jsx(e.Fragment,{children:e.jsx(W,{renderAriaLive:({firstIndex:t,lastIndex:a,totalItemsCount:o})=>`Displaying items ${t} to ${a} of ${o}`,onSelectionChange:({detail:t})=>g(t.selectedItems),selectedItems:n,ariaLabels:{selectionGroupLabel:"Items selection",allItemsSelectionLabel:()=>"select all",itemSelectionLabel:({selectedItems:t},a)=>a.name},columnDefinitions:[{id:"variable",header:"Name",cell:t=>t.name,isRowHeader:!0},{id:"value",header:"Creation date",cell:t=>t.created_date},{id:"description",header:"Number of expenses",cell:t=>t.expense_count}],columnDisplay:[{id:"variable",visible:!0},{id:"value",visible:!0},{id:"type",visible:!0},{id:"description",visible:!0}],enableKeyboardNavigation:!0,items:r,loadingText:"Loading categories",selectionType:"single",trackBy:"name",empty:e.jsx(G,{margin:{vertical:"xs"},textAlign:"center",color:"inherit",children:e.jsxs(j,{size:"m",children:[e.jsx("b",{children:"No category"}),e.jsx(f,{onClick:()=>c(`${x.path}/categories/add`),children:"Add category"})]})}),header:e.jsx(H,{counter:n.length?"("+n.length+`/${r.length})`:`(${r.length})`,actions:e.jsxs(j,{direction:"horizontal",size:"xs",children:[e.jsx(D,{onItemClick:b,items:[{text:"Edit",id:"edit",disabled:!1},{text:"Delete",id:"delete",disabled:!(n&&n[0]&&n[0].expense_count==0)}],children:"Actions"}),e.jsx(f,{variant:"primary",onClick:()=>c(`${x.path}/categories/add`),children:"Add category"}),e.jsxs(f,{onClick:l,children:[" ",e.jsx(P,{name:"refresh"})]})]}),children:"Your categories"})})})}function q(){const i=C();return e.jsx(K,{items:[{text:"Dashboard",href:O.path},{text:"Expense",href:`${x.path}`},{text:"All Categories",href:`${x.path}/categories`}],expandAriaLabel:"Show path",ariaLabel:"Breadcrumbs",onFollow:s=>{s.detail.external||(s.preventDefault(),i(s.detail.href))}})}function J(){return e.jsx(e.Fragment,{children:e.jsx(Y,{})})}function Z(){return e.jsx(e.Fragment,{children:e.jsx(U,{content:e.jsx(J,{}),breadcrumbs:e.jsx(q,{})})})}export{Z as default};

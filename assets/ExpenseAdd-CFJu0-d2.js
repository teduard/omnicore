import{u as z,R as H,a as N,b as T,r as a,c as V,j as e,L as Y,E as m,l as c,F as P,d as _,C as q,S as C,e as l,I as v,T as G,H as J,B as F,A as K}from"./index-B5AYm2nq.js";import{S as Q}from"./index-jymui-46.js";import{C as U}from"./internal-kWFzOJjt.js";import{u as W}from"./useExpenses-L1BB8N4s.js";import{E as X}from"./ExpenseLayout-DZ0FmJlf.js";import"./use-select-DBKZ3td9.js";function S({locale:u="",isDateEnabled:i=()=>!0,granularity:t="day",...n}){const d=z("Calendar",{props:{granularity:t},metadata:{hasDisabledReasons:!!n.dateDisabledReason}});return H.createElement(U,{...n,...d,locale:u,isDateEnabled:i,granularity:t})}N(S,"Calendar");function Z(){const u=T(),[i,t]=a.useState(""),[n,d]=a.useState(""),{execute:E,isReady:h}=V(),[D,y]=a.useState([{type:"info",dismissible:!0,dismissLabel:"Dismiss message",onDismiss:()=>y([]),content:e.jsxs(e.Fragment,{children:["Your new expense was added"," ",e.jsx(Y,{color:"inverted",href:`/omnicore/${m.path}/costlocal`,children:"see all expenses"}),"."]}),id:"added_expense"}]),A=s=>{d(parseFloat(s.detail.value).toString()),c.debug(s)},B=s=>{t(s.detail.value)},o=new Date,[p,R]=a.useState(o.getFullYear()+"-"+(o.getMonth()<9?"0"+(o.getMonth()+1):o.getMonth()+1)+"-"+o.getDate()),[x,g]=a.useState(!1),[b,j]=a.useState({label:"loading...",value:0}),{mutate:k,isPending:w}=W(),I=s=>{s.preventDefault();const r={amount:parseFloat(n),categoryId:parseInt(b.value),comment:i,date:p,couldHaveBeenAvoided:x};k(r,{onSuccess:()=>{M(!0),d(""),t(""),g(!1)},onError:()=>{c.debug("error on adding expense")}})},[L,M]=a.useState(!1),[O,$]=a.useState([]);return a.useEffect(()=>{if(h){const s=E("SELECT * FROM Categories where user_id = 1");c.debug("categories: ",s);const r=[];s&&s[0]&&s[0].values&&(s[0].values.map(f=>{r.push({label:f[2],value:f[0]})}),$(r),j(r[0]))}},[h]),e.jsxs(e.Fragment,{children:[L&&e.jsx(P,{items:D}),e.jsx("form",{onSubmit:I,children:e.jsx(_,{actions:e.jsxs(C,{direction:"horizontal",size:"xs",children:[e.jsx(F,{formAction:"none",variant:"link",onClick:()=>u("/dashboard/expense"),children:"Cancel"}),e.jsx(F,{variant:"primary",loading:w,children:"Add"})]}),children:e.jsx(q,{header:e.jsx(J,{variant:"h2",children:"New expense"}),children:e.jsxs(C,{direction:"vertical",size:"l",children:[e.jsx(l,{label:"Amount",children:e.jsx(v,{type:"number",value:n.toString(),onChange:A,placeholder:"0"})}),e.jsx(l,{label:"Category",children:e.jsx(Q,{selectedOption:b,onChange:({detail:s})=>j(s.selectedOption),options:O})}),e.jsx(l,{label:"Comment",children:e.jsx(v,{value:i,onChange:B})}),e.jsx(l,{label:"Could have been avoided",children:e.jsx(G,{onChange:({detail:s})=>g(s.checked),checked:x,children:"Yes"})}),e.jsx(l,{label:"Entry Date",children:e.jsx(S,{onChange:({detail:s})=>{c.debug("calendar:",s),R(s.value)},value:p})})]})})})})]})}function ee(){return e.jsx(e.Fragment,{children:e.jsx(Z,{})})}function se(){return e.jsx(K,{items:[{text:"Dashboard",href:m.path},{text:"Add expense",href:`${m.path}/add`}]})}function ie(){return e.jsx(X,{content:e.jsx(ee,{}),breadcrumbs:e.jsx(se,{})})}export{ie as default};

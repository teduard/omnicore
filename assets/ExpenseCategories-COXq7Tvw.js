import{R as y,u as $,h as k,f as R,g as L,i as S,k as T,m as N,a as F,r as h,n as M,c as P,b as z,j as e,H,S as j,B as f,E as g,o as G,p as K,l as C,A as O,D as U}from"./index-B5AYm2nq.js";import{E as W}from"./ExpenseLayout-DZ0FmJlf.js";import{T as Y}from"./index-_4hon0o-.js";const D=y.forwardRef(({items:o,variant:r="normal",loading:d=!1,loadingText:u,disabled:c=!1,disabledReason:m,expandableGroups:i=!1,expandToViewport:p=!1,ariaLabel:l,children:s,onItemClick:x,onItemFollow:b,mainAction:t,fullWidth:a,nativeMainActionAttributes:n,nativeTriggerAttributes:I,renderItem:A,..._},v)=>{const E=$("ButtonDropdown",{props:{expandToViewport:p,expandableGroups:i,variant:r},metadata:{mainAction:!!t,checkboxItems:R(o),hasDisabledReason:!!m,hasDisabledReasons:k(o)}}),B=L(_),w={name:"awsui.ButtonDropdown",label:`.${N["trigger-label"]}`,properties:{variant:r,disabled:`${c}`}};return y.createElement(S,{...B,...E,renderItem:A,ref:v,items:o,variant:r,loading:d,loadingText:u,disabled:c,disabledReason:m,expandableGroups:i,expandToViewport:p,ariaLabel:l,onItemClick:x,onItemFollow:b,mainAction:t,fullWidth:a,nativeMainActionAttributes:n,nativeTriggerAttributes:I,...T({component:w})},s)});F(D,"ButtonDropdown");function q(){const o=h.useContext(M);if(!o)throw new Error("useAuth must be used within AuthProvider");const{user:r}=o,{execute:d,isReady:u}=P(),c=z(),m=[],[i,p]=h.useState(m),l=()=>{const t=new Array,a=d(`
       select c.*, count(e.expense_id) as expense_count from Categories c
left join Expenses e
on c.user_id = e.user_id and c.category_id = e.category_id
where c.user_id =${r.UserId}
group by c.category_id
      
      `);!a||a.length===0?C.debug("no categories"):(a[0].values.map(n=>{t.push({category_id:n[0],user_id:n[1],name:n[2],created_date:n[3],expense_count:n[4]})}),p(t))};h.useEffect(()=>{u&&l()},[u]);const[s,x]=h.useState([]),b=t=>{switch(console.info(t),t.detail.id){case"edit":C.debug("edit category");break;case"delete":d(`DELETE FROM Categories where category_id = '${s[0].category_id}'`),l();break}};return e.jsx(e.Fragment,{children:e.jsx(Y,{renderAriaLive:({firstIndex:t,lastIndex:a,totalItemsCount:n})=>`Displaying items ${t} to ${a} of ${n}`,onSelectionChange:({detail:t})=>x(t.selectedItems),selectedItems:s,ariaLabels:{selectionGroupLabel:"Items selection",allItemsSelectionLabel:()=>"select all",itemSelectionLabel:({selectedItems:t},a)=>a.name},columnDefinitions:[{id:"variable",header:"Name",cell:t=>t.name,isRowHeader:!0},{id:"value",header:"Creation date",cell:t=>t.created_date},{id:"description",header:"Number of expenses",cell:t=>t.expense_count}],columnDisplay:[{id:"variable",visible:!0},{id:"value",visible:!0},{id:"type",visible:!0},{id:"description",visible:!0}],enableKeyboardNavigation:!0,items:i,loadingText:"Loading categories",selectionType:"single",trackBy:"name",empty:e.jsx(K,{margin:{vertical:"xs"},textAlign:"center",color:"inherit",children:e.jsxs(j,{size:"m",children:[e.jsx("b",{children:"No category"}),e.jsx(f,{onClick:()=>c(`${g.path}/categories/add`),children:"Add category"})]})}),header:e.jsx(H,{counter:s.length?"("+s.length+`/${i.length})`:`(${i.length})`,actions:e.jsxs(j,{direction:"horizontal",size:"xs",children:[e.jsx(D,{onItemClick:b,items:[{text:"Edit",id:"edit",disabled:!1},{text:"Delete",id:"delete",disabled:!(s&&s[0]&&s[0].expense_count==0)}],children:"Actions"}),e.jsx(f,{variant:"primary",onClick:()=>c(`${g.path}/categories/add`),children:"Add category"}),e.jsxs(f,{onClick:l,children:[" ",e.jsx(G,{name:"refresh"})]})]}),children:"Your categories"})})})}function J(){return e.jsx(O,{items:[{text:"Dashboard",href:U.path},{text:"Expense",href:`${g.path}`},{text:"All Categories",href:`${g.path}/categories`}]})}function Q(){return e.jsx(e.Fragment,{children:e.jsx(q,{})})}function ee(){return e.jsx(e.Fragment,{children:e.jsx(W,{content:e.jsx(Q,{}),breadcrumbs:e.jsx(J,{})})})}export{ee as default};

import{R as u,j as t,u as j,c as C,E as m,r as h,B as S,U as w}from"./index-Dz3i6rf-.js";import{E as I}from"./ExpenseCostExplorerTable-g6HZyW7A.js";import{E as v}from"./ExpenseLayout-DywuebGD.js";import{I as b}from"./index-C-ejrF0n.js";import"./MonthPicker-CaCM4zfZ.js";import"./internal-DaqPnNpa.js";const p={expenseAggregate:new Array,expenseTotal:0,LoadingStatus:"not-started"};function D({updateCategoryAggregate:o}){const s={ExpenseItemsCount:0,CouldHaveBeenAvoidedCount:0,LoadingStatus:"not-started"},[i,c]=u.useState(s),[n,f]=u.useState(new Array),[E,y]=u.useState(new Array),x=()=>{const d="http://localhost:9080/api/expense/get_all";c({...s,LoadingStatus:"loading"}),o({...p,LoadingStatus:"loading"}),fetch(d,{method:"GET",credentials:"include"}).then(r=>r.json()).then(r=>{f(r)})};return h.useEffect(()=>{const d=new Array;n.forEach(e=>{const a={expenseId:e.expenseId,entryDate:e.entryDate,amount:e.amount,category:e.category.name,comment:e.comment,couldHaveBeenAvoided:e.couldHaveBeenAvoided};d.push(a)}),y(d),c({ExpenseItemsCount:n.length,CouldHaveBeenAvoidedCount:n.filter(e=>e.couldHaveBeenAvoided===!0).length,LoadingStatus:"success"});const r=n.reduce((e,a)=>e+a.amount,0).toFixed(2),l=new Array;n.reduce((e,a)=>e.add(a.category.name),new Set).forEach(e=>{const a={categoryName:e,categoryAmount:0};a.categoryAmount=parseFloat(n.filter(g=>g.category.name===e).reduce((g,A)=>g+A.amount,0).toFixed(2)),l.push(a)}),o({...p,expenseAggregate:l,expenseTotal:r||0,LoadingStatus:"success"})},[n]),h.useEffect(()=>{x()},[]),t.jsxs(t.Fragment,{children:[t.jsxs(S,{variant:"primary",onClick:x,children:[t.jsx(b,{name:"refresh"}),"  Refresh"]}),t.jsx("br",{}),t.jsx("br",{}),t.jsxs(w,{gridDefinition:[{colspan:{default:12}}],children:[!1,t.jsx(I,{expenseData:E,LoadingStatus:i.LoadingStatus})]})]})}function L(){const o=j();return t.jsx(C,{items:[{text:"Dashboard",href:m.path},{text:"All expenses",href:`${m.path}/cost`}],expandAriaLabel:"Show path",ariaLabel:"Breadcrumbs",onFollow:s=>{s.detail.external||(s.preventDefault(),o(s.detail.href))}})}function U(){const o=c=>{i(c)},[s,i]=u.useState(p);return t.jsx(t.Fragment,{children:t.jsx(v,{content:t.jsx(D,{updateCategoryAggregate:o}),breadcrumbs:t.jsx(L,{})})})}export{U as default};

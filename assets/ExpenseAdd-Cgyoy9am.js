import{u as H,R as M,a as V,b as z,r as a,c as Y,j as e,L as P,F as U,d as q,C as G,S as F,e as r,I as E,T as J,H as K,B as A,l as i,A as Q,E as D}from"./index-CPvD-bK6.js";import{S as W}from"./index-MfXRJadI.js";import{C as X}from"./internal-CbUTSLOm.js";import{E as Z}from"./ExpenseLayout-dR5Mub-Z.js";import"./use-select-CLHQpZfY.js";function y({locale:c="",isDateEnabled:l=()=>!0,granularity:d="day",...n}){const u=H("Calendar",{props:{granularity:d},metadata:{hasDisabledReasons:!!n.dateDisabledReason}});return M.createElement(X,{...n,...u,locale:c,isDateEnabled:l,granularity:d})}V(y,"Calendar");function ee(){const c=z(),[l,d]=a.useState(""),[n,u]=a.useState(""),{execute:h,isReady:p}=Y(),[B,L]=a.useState([{type:"info",dismissible:!0,dismissLabel:"Dismiss message",onDismiss:()=>L([]),content:e.jsxs(e.Fragment,{children:["Your new expense was added"," ",e.jsx(P,{color:"inverted",href:"/expense",children:"see all expenses"}),"."]}),id:"added_expense"}]),R=t=>{u(parseFloat(t.detail.value).toString()),i.debug(t)},_=t=>{d(t.detail.value)},o=new Date,[x,k]=a.useState(o.getFullYear()+"-"+(o.getMonth()<9?"0"+(o.getMonth()+1):o.getMonth()+1)+"-"+o.getDate()),[g,$]=a.useState(!1),[f,b]=a.useState({label:"loading...",value:0}),[m,C]=a.useState("idle"),I=t=>{t.preventDefault();const s={Amount:parseFloat(n),Category:parseInt(f.value),Comment:l,Date:x,CouldHaveBeenAvoided:g};i.debug("payload:",s),C("fetching"),h(`INSERT INTO Expenses 
             (category_id, user_id,
             amount, comment, could_have_been_avoided, created_date, updated_date) VALUES 
             (${s.Category}, 1, ${s.Amount}, '${s.Comment}', ${s.CouldHaveBeenAvoided}, '${s.Date}', '${s.Date}')`),C("ok")},[w,j]=a.useState(!1),[N,v]=a.useState(!1);a.useEffect(()=>{v(m==="fetching"),j(m==="ok")},[m]);const[O,T]=a.useState([]);return a.useEffect(()=>{if(p){const t=h("SELECT * FROM Categories where user_id = 1");i.debug("categories: ",t);const s=[];t&&t[0]&&t[0].values&&(t[0].values.map(S=>{s.push({label:S[2],value:S[0]})}),T(s),b(s[0]))}},[p]),e.jsxs(e.Fragment,{children:[w&&e.jsx(U,{items:B}),e.jsx("form",{onSubmit:I,children:e.jsx(q,{actions:e.jsxs(F,{direction:"horizontal",size:"xs",children:[e.jsx(A,{formAction:"none",variant:"link",onClick:()=>c("/dashboard/expense"),children:"Cancel"}),e.jsx(A,{variant:"primary",loading:N,children:"Add"})]}),children:e.jsx(G,{header:e.jsx(K,{variant:"h2",children:"New expense"}),children:e.jsxs(F,{direction:"vertical",size:"l",children:[e.jsx(r,{label:"Amount",children:e.jsx(E,{type:"number",value:n.toString(),onChange:R,placeholder:"0"})}),e.jsx(r,{label:"Category",children:e.jsx(W,{selectedOption:f,onChange:({detail:t})=>b(t.selectedOption),options:O})}),e.jsx(r,{label:"Comment",children:e.jsx(E,{value:l,onChange:_})}),e.jsx(r,{label:"Could have been avoided",children:e.jsx(J,{onChange:({detail:t})=>$(t.checked),checked:g,children:"Yes"})}),e.jsx(r,{label:"Entry Date",children:e.jsx(y,{onChange:({detail:t})=>{i.debug("calendar:",t),k(t.value)},value:x})})]})})})})]})}function te(){return e.jsx(e.Fragment,{children:e.jsx(ee,{})})}function ae(){return e.jsx(Q,{items:[{text:"Dashboard",href:D.path},{text:"Add expense",href:`${D.path}/add`}]})}function de(){return e.jsx(Z,{content:e.jsx(te,{}),breadcrumbs:e.jsx(ae,{})})}export{de as default};

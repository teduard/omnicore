import{R as u,j as t,u as C,f as j,E as h,r as m,B as S,s as w,X as v}from"./index-i8URqjWk.js";import{E as D}from"./ExpenseCostExplorerTable-D4tjjTEd.js";import{E as I}from"./ExpenseLayout-Bg0ba4xj.js";import"./index-w18fh6ws.js";import"./MonthPicker-Cruv2OYY.js";import"./internal-Dxpm5i3b.js";const l={expenseAggregate:new Array,expenseTotal:0,LoadingStatus:"not-started"};function b({updateCategoryAggregate:o}){const s={ExpenseItemsCount:0,CouldHaveBeenAvoidedCount:0,LoadingStatus:"not-started"},[g,c]=u.useState(s),[n,f]=u.useState(new Array),[E,y]=u.useState(new Array),i=()=>{console.log("SECOND");const d="http://localhost:9080/api/expense/get_all";c({...s,LoadingStatus:"loading"}),o({...l,LoadingStatus:"loading"}),fetch(d,{method:"GET",credentials:"include"}).then(r=>r.json()).then(r=>{f(r)})};return m.useEffect(()=>{const d=new Array;n.forEach(e=>{const a={expenseId:e.expenseId,entryDate:e.entryDate,amount:e.amount,category:e.category.name,comment:e.comment,couldHaveBeenAvoided:e.couldHaveBeenAvoided};d.push(a)}),y(d),c({ExpenseItemsCount:n.length,CouldHaveBeenAvoidedCount:n.filter(e=>e.couldHaveBeenAvoided===!0).length,LoadingStatus:"success"});const r=n.reduce((e,a)=>e+a.amount,0).toFixed(2),x=new Array;n.reduce((e,a)=>e.add(a.category.name),new Set).forEach(e=>{const a={categoryName:e,categoryAmount:0};a.categoryAmount=parseFloat(n.filter(p=>p.category.name===e).reduce((p,A)=>p+A.amount,0).toFixed(2)),x.push(a)}),o({...l,expenseAggregate:x,expenseTotal:r||0,LoadingStatus:"success"})},[n]),m.useEffect(()=>{i()},[]),t.jsxs(t.Fragment,{children:[t.jsxs(S,{variant:"primary",onClick:i,children:[t.jsx(w,{name:"refresh"}),"  Refresh"]}),t.jsx("br",{}),t.jsx("br",{}),t.jsxs(v,{gridDefinition:[{colspan:{default:12}}],children:[!1,t.jsx(D,{expenseData:E,LoadingStatus:g.LoadingStatus,onMonthChange:i})]})]})}function L(){const o=C();return t.jsx(j,{items:[{text:"Dashboard",href:h.path},{text:"All expenses",href:`${h.path}/cost`}],expandAriaLabel:"Show path",ariaLabel:"Breadcrumbs",onFollow:s=>{s.detail.external||(s.preventDefault(),o(s.detail.href))}})}function M(){const o=c=>{g(c)},[s,g]=u.useState(l);return t.jsx(t.Fragment,{children:t.jsx(I,{content:t.jsx(b,{updateCategoryAggregate:o}),breadcrumbs:t.jsx(L,{})})})}export{M as default};

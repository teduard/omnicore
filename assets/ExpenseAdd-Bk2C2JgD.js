import{u as R,r as t,a as H,j as e,L as T,E as l,l as r,S as i,F as V,b as Y,C as $,c as o,I as v,T as _,B as C,H as N,A as P}from"./index-BNmEPKmQ.js";import{S as q}from"./index-CBO8KeFk.js";import{C as G}from"./index-GCtq89iY.js";import{u as J}from"./useExpenses-Dd4ZDJH_.js";import{E as K}from"./ExpenseLayout-JxUEBJy9.js";import"./use-select--nlNNOp5.js";function Q(){const F=R(),[d,c]=t.useState(""),[u,m]=t.useState(""),{execute:S,isReady:h}=H(),[E,A]=t.useState([{type:"info",dismissible:!0,dismissLabel:"Dismiss message",onDismiss:()=>A([]),content:e.jsxs(e.Fragment,{children:["Your new expense was added"," ",e.jsx(T,{color:"inverted",href:`/omnicore/${l.path}/costlocal`,children:"see all expenses"}),"."]}),id:"added_expense"}]),y=s=>{m(parseFloat(s.detail.value).toString()),r.debug(s)},D=s=>{c(s.detail.value)},a=new Date,[x,k]=t.useState(a.getFullYear()+"-"+(a.getMonth()<9?"0"+(a.getMonth()+1):a.getMonth()+1)+"-"+a.getDate()),[p,g]=t.useState(!1),[b,j]=t.useState({label:"loading...",value:0}),{mutate:B,isPending:I}=J(),L=s=>{s.preventDefault();const n={amount:parseFloat(u),categoryId:parseInt(b.value),comment:d,date:x,couldHaveBeenAvoided:p};B(n,{onSuccess:()=>{z(!0),m(""),c(""),g(!1)},onError:()=>{r.debug("error on adding expense")}})},[w,z]=t.useState(!1),[M,O]=t.useState([]);return t.useEffect(()=>{if(h){const s=S("SELECT * FROM Categories where user_id = 1");r.debug("categories: ",s);const n=[];s&&s[0]&&s[0].values&&(s[0].values.map(f=>{n.push({label:f[2],value:f[0]})}),O(n),j(n[0]))}},[h]),e.jsx(e.Fragment,{children:e.jsxs(i,{direction:"vertical",size:"l",children:[w&&e.jsx(V,{items:E}),e.jsx("form",{onSubmit:L,children:e.jsx(Y,{header:e.jsx(N,{variant:"h1",children:"Add expense"}),actions:e.jsxs(i,{direction:"horizontal",size:"xs",children:[e.jsx(C,{formAction:"none",variant:"link",onClick:()=>F("/dashboard/expense"),children:"Cancel"}),e.jsx(C,{variant:"primary",loading:I,children:"Add"})]}),children:e.jsx($,{children:e.jsxs(i,{direction:"vertical",size:"l",children:[e.jsx(o,{label:"Amount",children:e.jsx(v,{type:"number",value:u.toString(),onChange:y,placeholder:"0"})}),e.jsx(o,{label:"Category",children:e.jsx(q,{selectedOption:b,onChange:({detail:s})=>j(s.selectedOption),options:M})}),e.jsx(o,{label:"Comment",children:e.jsx(v,{value:d,onChange:D})}),e.jsx(o,{label:"Could have been avoided",children:e.jsx(_,{onChange:({detail:s})=>g(s.checked),checked:p,children:"Yes"})}),e.jsx(o,{label:"Entry Date",children:e.jsx(G,{onChange:({detail:s})=>{r.debug("calendar:",s),k(s.value)},value:x})})]})})})})]})})}function U(){return e.jsx(e.Fragment,{children:e.jsx(Q,{})})}function W(){return e.jsx(P,{items:[{text:"Dashboard",href:l.path},{text:"Add expense",href:`${l.path}/add`}]})}function ne(){return e.jsx(K,{content:e.jsx(U,{}),breadcrumbs:e.jsx(W,{})})}export{ne as default};

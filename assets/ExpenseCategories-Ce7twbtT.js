import{R as C,h as $,i as k,k as R,l as L,m as S,n as T,o as F,p as N,r as m,A as M,q as z,u as A,j as e,H,S as D,B as I,E as p,s as P,t as G,f as U,D as q}from"./index-i8URqjWk.js";import"./index-D_lqj6Qb.js";import{E as K}from"./ExpenseLayout-Bg0ba4xj.js";import{T as O}from"./index-w18fh6ws.js";const _=C.forwardRef(({items:i,variant:n="normal",loading:j=!1,loadingText:g,disabled:h=!1,disabledReason:r,expandableGroups:l=!1,expandToViewport:c=!1,ariaLabel:x,children:d,onItemClick:b,onItemFollow:u,mainAction:a,fullWidth:f,nativeMainActionAttributes:y,nativeTriggerAttributes:t,renderItem:s,...o},B)=>{const E=$("ButtonDropdown",{props:{expandToViewport:c,expandableGroups:l,variant:n},metadata:{mainAction:!!a,checkboxItems:R(i),hasDisabledReason:!!r,hasDisabledReasons:k(i)}}),v=L(o),w={name:"awsui.ButtonDropdown",label:`.${F["trigger-label"]}`,properties:{variant:n,disabled:`${h}`}};return C.createElement(S,{...v,...E,renderItem:s,ref:B,items:i,variant:n,loading:j,loadingText:g,disabled:h,disabledReason:r,expandableGroups:l,expandToViewport:c,ariaLabel:x,onItemClick:b,onItemFollow:u,mainAction:a,fullWidth:f,nativeMainActionAttributes:y,nativeTriggerAttributes:t,...T({component:w})},d)});N(_,"ButtonDropdown");function W(){const i=m.useContext(M),{isAuthenticated:n,setIsAuthenticated:j,user:g,setUser:h}=i,{execute:r,isReady:l}=z(),c=A(),x=[],[d,b]=m.useState(x),u=()=>{const t=new Array,s=r(`
       select c.*, count(e.expense_id) as expense_count from Categories c
left join Expenses e
on c.user_id = e.user_id and c.category_id = e.category_id
where c.user_id =${g.UserId}
group by c.category_id
      
      `);console.log("fetch categories. res = ",s),!s||s.length===0?console.log("no categories"):(s[0].values.map(o=>{t.push({category_id:o[0],user_id:o[1],name:o[2],created_date:o[3],expense_count:o[4]})}),b(t))};m.useEffect(()=>{l&&u()},[l]);const[a,f]=m.useState([]),y=t=>{switch(t.detail.id){case"edit":console.log("edit category");break;case"delete":console.log("delete category"),console.log(t.detail),console.log("selectedItems = ",a),r(`DELETE FROM Categories where category_id = '${a[0].category_id}'`),u();break}};return m.useEffect(()=>{console.log("selectedItems = ",a)},[a]),e.jsx(e.Fragment,{children:e.jsx(O,{renderAriaLive:({firstIndex:t,lastIndex:s,totalItemsCount:o})=>`Displaying items ${t} to ${s} of ${o}`,onSelectionChange:({detail:t})=>f(t.selectedItems),selectedItems:a,ariaLabels:{selectionGroupLabel:"Items selection",allItemsSelectionLabel:()=>"select all",itemSelectionLabel:({selectedItems:t},s)=>s.name},columnDefinitions:[{id:"variable",header:"Name",cell:t=>t.name,isRowHeader:!0},{id:"value",header:"Creation date",cell:t=>t.created_date},{id:"description",header:"Number of expenses",cell:t=>t.expense_count}],columnDisplay:[{id:"variable",visible:!0},{id:"value",visible:!0},{id:"type",visible:!0},{id:"description",visible:!0}],enableKeyboardNavigation:!0,items:d,loadingText:"Loading categories",selectionType:"single",trackBy:"name",empty:e.jsx(G,{margin:{vertical:"xs"},textAlign:"center",color:"inherit",children:e.jsxs(D,{size:"m",children:[e.jsx("b",{children:"No category"}),e.jsx(I,{onClick:()=>c(`${p.path}/categories/add`),children:"Add category"})]})}),header:e.jsx(H,{counter:a.length?"("+a.length+`/${d.length})`:`(${d.length})`,actions:e.jsxs(D,{direction:"horizontal",size:"xs",children:[e.jsx(_,{onItemClick:y,items:[{text:"Edit",id:"edit",disabled:!1},{text:"Delete",id:"delete",disabled:!(a&&a[0]&&a[0].expense_count==0)}],children:"Actions"}),e.jsx(I,{variant:"primary",onClick:()=>c(`${p.path}/categories/add`),children:"Add category"}),e.jsxs(I,{onClick:u,children:[" ",e.jsx(P,{name:"refresh"})]})]}),children:"Your categories"})})})}function Y(){const i=A();return e.jsx(U,{items:[{text:"Dashboard",href:q.path},{text:"Expense",href:`${p.path}`},{text:"All Categories",href:`${p.path}/categories`}],expandAriaLabel:"Show path",ariaLabel:"Breadcrumbs",onFollow:n=>{n.detail.external||(n.preventDefault(),i(n.detail.href))}})}function J(){return e.jsx(e.Fragment,{children:e.jsx(W,{})})}function ee(){return e.jsx(e.Fragment,{children:e.jsx(K,{content:e.jsx(J,{}),breadcrumbs:e.jsx(Y,{})})})}export{ee as default};

import{u as z,r as t,a as H,j as e,L as T,E as l,l as r,F as V,b as Y,C as $,S as f,c as o,I as v,T as N,H as _,B as C,A as P}from"./index-D5ZTpl4d.js";import{S as q}from"./index-CvlSTGqc.js";import{C as G}from"./index-7IoUYSpT.js";import{u as J}from"./useExpenses-BlkLOWNp.js";import{E as K}from"./ExpenseLayout-DuAMmXcG.js";import"./use-select-seJ8svN_.js";function Q(){const F=z(),[i,d]=t.useState(""),[c,u]=t.useState(""),{execute:S,isReady:m}=H(),[E,A]=t.useState([{type:"info",dismissible:!0,dismissLabel:"Dismiss message",onDismiss:()=>A([]),content:e.jsxs(e.Fragment,{children:["Your new expense was added"," ",e.jsx(T,{color:"inverted",href:`/omnicore/${l.path}/costlocal`,children:"see all expenses"}),"."]}),id:"added_expense"}]),y=s=>{u(parseFloat(s.detail.value).toString()),r.debug(s)},D=s=>{d(s.detail.value)},a=new Date,[h,k]=t.useState(a.getFullYear()+"-"+(a.getMonth()<9?"0"+(a.getMonth()+1):a.getMonth()+1)+"-"+a.getDate()),[x,p]=t.useState(!1),[g,b]=t.useState({label:"loading...",value:0}),{mutate:w,isPending:B}=J(),I=s=>{s.preventDefault();const n={amount:parseFloat(c),categoryId:parseInt(g.value),comment:i,date:h,couldHaveBeenAvoided:x};w(n,{onSuccess:()=>{M(!0),u(""),d(""),p(!1)},onError:()=>{r.debug("error on adding expense")}})},[L,M]=t.useState(!1),[O,R]=t.useState([]);return t.useEffect(()=>{if(m){const s=S("SELECT * FROM Categories where user_id = 1");r.debug("categories: ",s);const n=[];s&&s[0]&&s[0].values&&(s[0].values.map(j=>{n.push({label:j[2],value:j[0]})}),R(n),b(n[0]))}},[m]),e.jsxs(e.Fragment,{children:[L&&e.jsx(V,{items:E}),e.jsx("form",{onSubmit:I,children:e.jsx(Y,{actions:e.jsxs(f,{direction:"horizontal",size:"xs",children:[e.jsx(C,{formAction:"none",variant:"link",onClick:()=>F("/dashboard/expense"),children:"Cancel"}),e.jsx(C,{variant:"primary",loading:B,children:"Add"})]}),children:e.jsx($,{header:e.jsx(_,{variant:"h2",children:"New expense"}),children:e.jsxs(f,{direction:"vertical",size:"l",children:[e.jsx(o,{label:"Amount",children:e.jsx(v,{type:"number",value:c.toString(),onChange:y,placeholder:"0"})}),e.jsx(o,{label:"Category",children:e.jsx(q,{selectedOption:g,onChange:({detail:s})=>b(s.selectedOption),options:O})}),e.jsx(o,{label:"Comment",children:e.jsx(v,{value:i,onChange:D})}),e.jsx(o,{label:"Could have been avoided",children:e.jsx(N,{onChange:({detail:s})=>p(s.checked),checked:x,children:"Yes"})}),e.jsx(o,{label:"Entry Date",children:e.jsx(G,{onChange:({detail:s})=>{r.debug("calendar:",s),k(s.value)},value:h})})]})})})})]})}function U(){return e.jsx(e.Fragment,{children:e.jsx(Q,{})})}function W(){return e.jsx(P,{items:[{text:"Dashboard",href:l.path},{text:"Add expense",href:`${l.path}/add`}]})}function ne(){return e.jsx(K,{content:e.jsx(U,{}),breadcrumbs:e.jsx(W,{})})}export{ne as default};

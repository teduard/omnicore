const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/highcharts-CsQtL4Y0.js","assets/index-BSWcVoFG.js","assets/index-BSSfyT4z.css","assets/accessibility-Bf014_6x.js","assets/highcharts-more-D2TItGGP.js"])))=>i.map(i=>d[i]);
import{G as k,R as r,J as se,x as L,K as le,N as ie,f as ce,i as de,t as q,r as d,O as ue,v as X,P as ee,z as ge,n as he,j as t,C as $,H as T,p as D,L as G,_ as K,S as H,B as pe,u as me,c as xe,D as Ce,E as fe,o as _e,Q as Ee,M as ye,d as Pe,e as be,U}from"./index-BSWcVoFG.js";import{S as I,c as ve,a as we,b as Ae,d as De,e as Se,f as je,g as Ie,h as Le,i as Te,j as Be,k as Ne,l as Re,m as Fe,n as Me,o as ke,p as He,q as $e,r as Oe,s as ze,t as Ve,u as Ye,v as qe,w as Ke,x as Ue,y as We,z as Ge,A as Qe,B as Ze,C as Je,D as Xe,E as et,F as tt,G as at,H as st,I as rt,J as ot,K as nt,L as lt,M as it,N as ct,O as dt,P as ut,Q as gt,R as ht,T as pt,U as mt,V as xt,W as Ct,X as ft,Y as _t,Z as Et}from"./index-BpThITCJ.js";import{T as Q}from"./index-CzVpi0f_.js";import{M as yt}from"./MonthPicker-JQLS-2ZG.js";import{E as Pt}from"./ExpenseLayout-CG0SlaGy.js";import"./use-select--a4UyXx6.js";import"./internal-CFthdE5u.js";function bt(e){if(e?.progressBar)return{[k.progressBarBackgroundColor]:e.progressBar.backgroundColor,[k.progressBarBorderRadius]:e.progressBar.borderRadius,[k.progressBarHeight]:e.progressBar.height}}function vt(e){if(e?.progressValue)return{[k.progressValueBackgroundColor]:e.progressValue.backgroundColor}}function wt(e){if(e?.progressPercentage)return{color:e.progressPercentage.color,fontSize:e.progressPercentage.fontSize,fontWeight:e.progressPercentage.fontWeight}}const c={progress:"awsui_progress_11huc_1oe95_189","result-state":"awsui_result-state_11huc_1oe95_203","awsui-motion-fade-in":"awsui_awsui-motion-fade-in_11huc_1oe95_1",root:"awsui_root_11huc_1oe95_225","with-result-button":"awsui_with-result-button_11huc_1oe95_257","result-text":"awsui_result-text_11huc_1oe95_261","result-container-error":"awsui_result-container-error_11huc_1oe95_265","result-container-success":"awsui_result-container-success_11huc_1oe95_265","result-button":"awsui_result-button_11huc_1oe95_269","word-wrap":"awsui_word-wrap_11huc_1oe95_275","label-flash":"awsui_label-flash_11huc_1oe95_280","label-key-value":"awsui_label-key-value_11huc_1oe95_284",flash:"awsui_flash_11huc_1oe95_292","progress-container":"awsui_progress-container_11huc_1oe95_296","percentage-container":"awsui_percentage-container_11huc_1oe95_303",percentage:"awsui_percentage_11huc_1oe95_303",complete:"awsui_complete_11huc_1oe95_349","additional-info":"awsui_additional-info_11huc_1oe95_363"},W=100,At=(e,a,s)=>Math.max(Math.min(e,s),a),Dt=({value:e,isInFlash:a,ariaLabel:s,ariaLabelledby:n,ariaDescribedby:o,style:i})=>{const C=Math.round(e),y=At(C,0,W),P=bt(i),m=vt(i),w=wt(i);return r.createElement("div",{className:c["progress-container"]},r.createElement("progress",{className:L(c.progress,y>=W&&c.complete),max:W,value:y,"aria-label":s,"aria-labelledby":s?void 0:n,"aria-describedby":o,style:{...P||{},...m||{}}}),r.createElement("span",{"aria-hidden":"true",className:c["percentage-container"]},r.createElement(se,{className:c.percentage,variant:"small",color:a?"inherit":void 0,nativeAttributes:w?{style:w}:void 0},`${y}%`)))},te=({color:e,children:a,className:s,id:n})=>r.createElement(se,{className:L(c["word-wrap"],s),variant:"small",display:"block",color:e,id:n},a),St=({onClick:e,children:a})=>r.createElement("div",{className:c["result-button"]},r.createElement(ie,{formAction:"none",onClick:e},a)),jt=({isInFlash:e,resultText:a,resultButtonText:s,status:n,onClick:o})=>{const i=!!s;return e?r.createElement("div",{className:c[`result-container-${n}`]},r.createElement("span",{className:c["result-text"]},a)):r.createElement("div",{className:c[`result-container-${n}`]},r.createElement("span",{className:L(i&&c["with-result-button"])},r.createElement(le,{type:n==="success"?"success":"error"},r.createElement("span",{className:c["result-text"]},a))),i&&r.createElement(St,{onClick:o},s))},It=5e3;function re({value:e=0,status:a="in-progress",variant:s="standalone",resultButtonText:n,label:o,ariaLabel:i,ariaLabelledby:C,ariaDescribedby:y,description:P,additionalInfo:m,resultText:w,onResultButtonClick:S,style:b,...B}){const{__internalRootRef:N}=ce("ProgressBar",{props:{variant:s}}),O=de(B),x=`${q("awsui-progress-bar-")}-label`,v=s==="flash",z=a==="in-progress",R=q("progressbar-description-"),j=q("progressbar-additional-info-"),[F,g]=d.useState(""),f=ue(h=>{g(`${h}%`)},It,[]);return d.useEffect(()=>{f(e)},[f,e]),r.createElement("div",{...O,className:L(O.className,c.root,s&&c[s]),ref:N},r.createElement("div",{className:v?c["flash-container"]:void 0},r.createElement("div",{className:L(c["word-wrap"],c[`label-${s}`]),id:x},o),P&&r.createElement(te,{color:v?"inherit":void 0,id:R},P),r.createElement("div",null,z?r.createElement(r.Fragment,null,r.createElement(Dt,{value:e,ariaLabel:i,ariaLabelledby:X(x,C),ariaDescribedby:X(P?R:void 0,m?j:void 0,y),isInFlash:v,style:b}),r.createElement(ee,{hidden:!0,tagName:"span",delay:0},o,o?": ":null,F)):r.createElement(ee,{hidden:!1,tagName:"span",delay:0},r.createElement(jt,{resultText:w,isInFlash:v,resultButtonText:n,status:a,onClick:()=>{ge(S)}})))),m&&r.createElement(te,{className:c["additional-info"],color:v?"inherit":void 0,id:j},m))}he(re,"ProgressBar");function Lt(){const[e,a]=d.useState(!0);return d.useEffect(()=>{function s(){console.log("in hook, handle online"),a(!0)}function n(){console.log("in hook, handle offline"),a(!1)}return window.addEventListener("online",s),window.addEventListener("offline",n),()=>{window.removeEventListener("online",s),window.removeEventListener("offline",n)}},[]),e}function Tt({insightsDefinition:e,insightsItems:a,loadingStatus:s}){return s==="not-started"?t.jsx(D,{textAlign:"center",children:t.jsx(I,{type:"info",children:"Insights not loaded. Reload page"})}):s==="loading"?t.jsx(D,{textAlign:"center",children:t.jsx(I,{type:"loading",children:"Loading"})}):s==="error"?t.jsx(D,{textAlign:"center",children:t.jsx(I,{type:"error",children:"Error loading insights"})}):t.jsx(Q,{enableKeyboardNavigation:!0,variant:"borderless",resizableColumns:!0,items:a,columnDefinitions:e})}function Bt(e){const a=[{id:"name",header:"Metric",cell:n=>n.name,width:160,isRowHeader:!0},{id:"status",header:"Count",cell:({statusText:n,status:o})=>t.jsx(I,{type:o,children:n})}],s=[{name:"Expense days",statusText:e.ExpenseItemsCount.toString(),status:"info"},{name:"Total transactions",statusText:e.ExpenseItemsCount.toString(),status:"info"},{name:"Avoidable expenses",statusText:e.CouldHaveBeenAvoidedCount.toString(),status:"warning"}];return t.jsx($,{header:t.jsx(T,{variant:"h2",description:"What to look after",children:"Insights"}),children:t.jsx(Tt,{insightsDefinition:a,insightsItems:s,loadingStatus:e.LoadingStatus})})}const Nt=[{id:"name",header:"Category",cell:e=>t.jsx(G,{href:"#",children:e.name}),width:160,isRowHeader:!0},{id:"status",header:"Total Spent",cell:({statusText:e,status:a})=>e+" RON",width:140},{id:"quota",header:"Budget quota",cell:({statusText:e,status:a})=>t.jsxs(t.Fragment,{children:[t.jsx(I,{type:a,children:"30%"})," ","/"," ",parseFloat(e)*2," RON"]})}];function Rt(e){const[a,s]=r.useState();return d.useEffect(()=>{const n=new Array;e.expenseAggregate.forEach(i=>{n.push({name:i.categoryName,statusText:i.categoryAmount.toString(),status:"info"})}),s(n)},[e.expenseAggregate]),t.jsx($,{header:t.jsx(T,{variant:"h2",description:"Transactions aggregated by category",children:"Category summary"}),children:t.jsx(Q,{enableKeyboardNavigation:!0,variant:"borderless",resizableColumns:!0,items:a,columnDefinitions:Nt,loading:e.LoadingStatus==="loading",loadingText:"Loading category aggregates",footer:t.jsx(D,{textAlign:"center",children:t.jsxs("h3",{children:["Total: ",t.jsxs("b",{children:[e.expenseTotal," RON"]})]})})})})}const ae=e=>`${(e*100).toFixed(0)}%`,Ft=()=>{const[e,a]=d.useState(null);return d.useEffect(()=>{(async()=>{const n=await K(()=>import("./highcharts-CsQtL4Y0.js").then(o=>o.h),__vite__mapDeps([0,1,2]));await K(()=>import("./accessibility-Bf014_6x.js").then(o=>o.a),__vite__mapDeps([3,1,2])),await K(()=>import("./highcharts-more-D2TItGGP.js").then(o=>o.h),__vite__mapDeps([4,1,2])),a(n)})()},[]),e},Mt=[ve,we,Ae,De,Se,je,Ie,Le,Te,Be,Ne,Re,Fe,Me,ke,He,$e,Oe,ze,Ve,Ye,qe,Ke,Ue,We,Ge,Qe,Ze,Je,Xe,et,tt,at,st,rt,ot,nt,lt,it,ct,dt,ut,gt,ht,pt,mt,xt,Ct,ft,_t];function kt(e){const a=Ft(),[s,n]=d.useState([]);return d.useEffect(()=>{const o=new Array;let i=0;e.expenseAggregate.forEach(C=>{C.categoryAmount>0&&o.push({name:C.categoryName,y:C.categoryAmount,color:Mt[i++]})}),n(o)},[e.expenseAggregate]),t.jsx(t.Fragment,{children:t.jsx($,{header:t.jsx(T,{variant:"h2",description:"Your expenses at a glance",children:"Expenses aggregate by category"}),children:t.jsx(Et,{highcharts:a,noData:{statusType:"loading"},series:{type:"donut",name:"Zone status",data:s},ariaLabel:"Category aggregate chart",innerAreaDescription:"RON",innerAreaTitle:e.expenseTotal.toString(),segmentDescription:({segmentValue:o,totalValue:i})=>`${o} zones, ${ae(o/i)}`,tooltip:{details:({segmentValue:o,totalValue:i})=>[{key:"Zone count",value:o},{key:"Percentage",value:ae(o/i)}]},i18nStrings:{chartRoleDescription:"Pie chart summarizing the status of all zones.",seriesFilterLabel:"Filter displayed data",seriesFilterPlaceholder:"Filter data",seriesFilterSelectedAriaLabel:"selected",detailPopoverDismissAriaLabel:"Dismiss",legendAriaLabel:"Legend",segmentRoleDescription:"segment"}})})})}function Ht(e){return t.jsx(Q,{loading:e.LoadingStatus==="loading",loadingText:"Loading expenses",renderAriaLive:({firstIndex:a,lastIndex:s,totalItemsCount:n})=>`Displaying items ${a} to ${s} of ${n}`,columnDefinitions:[{id:"entryDate",header:"Entry Date",cell:a=>t.jsx(G,{href:"/expense/edit/"+a.expenseId,children:a.entryDate||"-"}),sortingField:"name",isRowHeader:!0},{id:"amount",header:"Amount",cell:a=>a.amount||"-",sortingField:"alt"},{id:"category",header:"Category",cell:a=>a.category||"-"},{id:"comment",header:"Comment",cell:a=>a.comment||"-"}],enableKeyboardNavigation:!0,items:e.expenseData,sortingDisabled:!0,stripedRows:!0,empty:t.jsx(D,{margin:{vertical:"xs"},textAlign:"center",color:"inherit",children:t.jsxs(H,{size:"m",children:[t.jsx("b",{children:"No resources"}),t.jsx(pe,{children:"Create resource"})]})}),header:t.jsx(T,{children:" Latest Expenses "}),footer:t.jsx(D,{textAlign:"center",children:t.jsx(G,{href:"/expense/cost",variant:"primary",children:"View all expenses"})})})}function $t(){const{execute:e,isReady:a}=_e(),{selectedDate:s,updateDate:n}=Ee();Lt();const[o,i]=d.useState("There are 13 days till the end of month: "+s),[C,y]=d.useState(13);d.useEffect(()=>{const g=new Date,f=g.getDate(),h=g.getMonth(),A=g.getFullYear(),l=parseInt(s.split("-")[0]),u=parseInt(s.split("-")[1])-1;if(console.log("DATES: ",A,h,l,u),A==l&&h==u){const _=new Date(A,h,1),E=new Date(A,h,f),p=new Date(l,u+1,0),M=1e3*60*60*24,oe=p.getTime()-E.getTime()+M,V=Math.round(oe/M);console.log(E,p,_),i(`There are ${V} days till the end of month.`);const ne=p.getTime()-_.getTime()+M,Y=Math.round(ne/M);console.log("DAYS: ",V,Y);const J=(Y-V)/Y*100;console.log("progress:",J),y(J)}else i("This month has passed"),y(100)},[s]);const P={ExpenseItemsCount:0,CouldHaveBeenAvoidedCount:0,LoadingStatus:"not-started"},[m,w]=r.useState(P),S={expenseAggregate:new Array,expenseTotal:0,LoadingStatus:"not-started"},[b,B]=r.useState(S),[N,O]=d.useState(ye.Light),Z={tokens:{colorBackgroundLayoutMain:{light:"white",dark:"blue"},colorTextAccent:"#0073bb"},contexts:{"top-navigation":{tokens:{colorBackgroundContainerContent:"#1e324f"}}}};d.useEffect(()=>{Pe(N),be({theme:Z})},[N]);const[x,v]=r.useState(new Array),[z,R]=r.useState(new Array),j=()=>{const g=new Array,f=s.split("-"),h=parseInt(f[0]),A=parseInt(f[1]),l=new Date(h,A,0),u=`${l.getFullYear()}-${l.getMonth()<9?"0"+(l.getMonth()+1):l.getMonth()+1}-${l.getDate()}}`,_=`SELECT e.*,c.name, c.category_id FROM Expenses e
      join Categories c
      on e.category_id = c.category_id
      WHERE 
      e.created_date >= '${s}-01' and e.created_date <= '${u}'
      `;console.log("sql = ",_);const E=e(_);return console.log("fetch expenses. res = ",E),console.log("selectedDate = ",s),!E||E.length===0?console.log("no expenses"):(E[0].values.map(p=>{g.push({expenseId:p[0],category:{name:p[8],categoryId:p[9]},entryDate:p[6],amount:p[3],comment:p[4],couldHaveBeenAvoided:p[5]})}),console.log("catData:",g)),g};d.useEffect(()=>{a&&v(j())},[a]);const F=()=>{console.log("IN updateExpenseHandler"),w({...P,LoadingStatus:"loading"}),B({...S,LoadingStatus:"loading"}),v(j())};return d.useEffect(()=>{const g=new Array;x.forEach(l=>{const u={expenseId:l.expenseId,entryDate:l.entryDate,amount:l.amount,category:l.category.name,comment:l.comment,couldHaveBeenAvoided:l.couldHaveBeenAvoided};g.push(u)}),R(g.slice(Math.max(g.length-10,0))),w({ExpenseItemsCount:x.length,CouldHaveBeenAvoidedCount:x.filter(l=>l.couldHaveBeenAvoided===!0).length,LoadingStatus:"success"});const f=x.reduce((l,u)=>l+u.amount,0).toFixed(2),h=new Array;x.reduce((l,u)=>l.add(u.category.name),new Set).forEach(l=>{const u={categoryName:l,categoryAmount:0};u.categoryAmount=parseFloat(x.filter(_=>_.category.name===l).reduce((_,E)=>_+E.amount,0).toFixed(2)),h.push(u)}),B({...S,expenseAggregate:h,expenseTotal:f||0,LoadingStatus:"success"})},[x]),d.useEffect(()=>{F()},[]),t.jsx(t.Fragment,{children:t.jsxs(U,{gridDefinition:[{colspan:{default:12}},{colspan:{default:12}}],children:[t.jsx($,{header:t.jsx(T,{variant:"h1",children:"Current status"}),children:t.jsxs(U,{gridDefinition:[{colspan:{default:7}},{colspan:{default:5}}],children:[t.jsx("div",{children:t.jsx(re,{value:C,additionalInfo:o,label:"Month progress"})}),t.jsx(H,{direction:"vertical",size:"l",children:t.jsx(yt,{onRefresh:F})})]})}),t.jsxs(U,{gridDefinition:[{colspan:{default:12,m:7,s:8,l:6,xl:6,xxs:12,xs:12}},{colspan:{default:12,m:5,s:4,l:6,xl:6,xxs:12,xs:12}}],children:[t.jsxs(H,{size:"l",children:[t.jsx(kt,{LoadingStatus:b.LoadingStatus,expenseAggregate:b.expenseAggregate,expenseTotal:b.expenseTotal}),t.jsx(Ht,{expenseData:z,LoadingStatus:m.LoadingStatus})]}),t.jsxs(H,{size:"l",children:[t.jsx(Bt,{ExpenseItemsCount:m.ExpenseItemsCount,CouldHaveBeenAvoidedCount:m.CouldHaveBeenAvoidedCount,LoadingStatus:m.LoadingStatus}),t.jsx(Rt,{LoadingStatus:b.LoadingStatus,expenseAggregate:b.expenseAggregate,expenseTotal:b.expenseTotal})]})]})]})})}function Ot(){const e=me();return t.jsx(xe,{items:[{text:"Dashboard",href:Ce.path},{text:"Expense",href:fe.path}],expandAriaLabel:"Show path",ariaLabel:"Breadcrumbs",onFollow:a=>{a.detail.external||(a.preventDefault(),e(a.detail.href))}})}function Gt(){return t.jsx(t.Fragment,{children:t.jsx(Pt,{content:t.jsx($t,{}),breadcrumbs:t.jsx(Ot,{})})})}export{Gt as default};

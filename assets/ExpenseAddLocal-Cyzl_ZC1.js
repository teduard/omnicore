import{u as E,r as a,j as e,L as H,C as M,S as C,H as N,B as v,a as V,E as S}from"./index-Bj2MUn9q.js";import{F as z,a as Y,I as F}from"./index-Cp1-mWVn.js";import{F as r}from"./index-Ccz6MWjI.js";import{S as G,C as U}from"./index-CD5wQho1.js";import{u as q}from"./useDatabase-Ddn2wrX2.js";import{T as J}from"./index-D2IAMnqL.js";import{E as K}from"./ExpenseLayout-DQHk7F6L.js";import"./internal-CSiE5gFz.js";import"./use-select-xZE1YDyp.js";function P(){const l=E(),[n,A]=a.useState(""),[d,D]=a.useState(""),{execute:c,isReady:u}=q(),[y,L]=a.useState([{type:"info",dismissible:!0,dismissLabel:"Dismiss message",onDismiss:()=>L([]),content:e.jsxs(e.Fragment,{children:["Your new expense was added"," ",e.jsx(H,{color:"inverted",href:"/expense",children:"see all expenses"}),"."]}),id:"added_expense"}]),B=t=>{D(parseFloat(t.detail.value).toString()),console.log(t)},_=t=>{A(t.detail.value)},o=new Date,[m,k]=a.useState(o.getFullYear()+"-"+(o.getMonth()<9?"0"+(o.getMonth()+1):o.getMonth()+1)+"-"+o.getDate()),[h,w]=a.useState(!1),[x,p]=a.useState({label:"loading...",value:0}),[i,f]=a.useState("idle"),I=t=>{t.preventDefault();const s={Amount:parseFloat(d),Category:parseInt(x.value),Comment:n,Date:m,CouldHaveBeenAvoided:h};console.log("payload:",s),f("fetching"),c(`INSERT INTO Expenses 
             (category_id, user_id,
             amount, comment, could_have_been_avoided, created_date, updated_date) VALUES 
             (${s.Category}, 1, ${s.Amount}, '${s.Comment}', ${s.CouldHaveBeenAvoided}, '${s.Date}', '${s.Date}')`),f("ok")},[$,g]=a.useState(!1),[O,b]=a.useState(!1);a.useEffect(()=>{b(i==="fetching"),g(i==="ok")},[i]);const[R,T]=a.useState([]);return a.useEffect(()=>{if(u){const t=c("SELECT * FROM Categories where user_id = 1");console.log("categories: ",t);const s=[];t&&t[0]&&t[0].values&&(t[0].values.map(j=>{s.push({label:j[2],value:j[0]})}),T(s),p(s[0]))}},[u]),e.jsxs(e.Fragment,{children:[$&&e.jsx(z,{items:y}),e.jsx("form",{onSubmit:I,children:e.jsx(Y,{actions:e.jsxs(C,{direction:"horizontal",size:"xs",children:[e.jsx(v,{formAction:"none",variant:"link",onClick:()=>l("/dashboard/expense"),children:"Cancel"}),e.jsx(v,{variant:"primary",loading:O,children:"Add"})]}),children:e.jsx(M,{header:e.jsx(N,{variant:"h2",children:"New expense"}),children:e.jsxs(C,{direction:"vertical",size:"l",children:[e.jsx(r,{label:"Amount",children:e.jsx(F,{type:"number",value:d.toString(),onChange:B,placeholder:"0"})}),e.jsx(r,{label:"Category",children:e.jsx(G,{selectedOption:x,onChange:({detail:t})=>p(t.selectedOption),options:R})}),e.jsx(r,{label:"Comment",children:e.jsx(F,{value:n,onChange:_})}),e.jsx(r,{label:"Could have been avoided",children:e.jsx(J,{onChange:({detail:t})=>w(t.checked),checked:h,children:"Yes"})}),e.jsx(r,{label:"Entry Date",children:e.jsx(U,{onChange:({detail:t})=>{console.log("calendar:",t),k(t.value)},value:m})})]})})})})]})}function Q(){return e.jsx(e.Fragment,{children:e.jsx(P,{})})}function W(){const l=E();return e.jsx(V,{items:[{text:"Dashboard",href:S.path},{text:"Add expense",href:`${S.path}/add`}],expandAriaLabel:"Show path",ariaLabel:"Breadcrumbs",onFollow:n=>{n.detail.external||(n.preventDefault(),l(n.detail.href))}})}function le(){return e.jsx(K,{content:e.jsx(Q,{}),breadcrumbs:e.jsx(W,{})})}export{le as default};
